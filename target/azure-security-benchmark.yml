microsoftCloudSecurityBenchmark:
  title: Microsoft cloud security benchmark Regulatory Compliance
  categories:
  - name: Network Security
    subcategories:
    - name: Establish network segmentation boundaries
      id: Microsoft cloud security benchmark NS-1
      ownership: Shared
      policies:
      - name: '[All network ports should be restricted on network security groups
          associated to your virtual machine](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9daedab3-fb2d-461e-b861-71790eead4f6)'
        reference: '[All network ports should be restricted on network security groups
          associated to your virtual machine](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9daedab3-fb2d-461e-b861-71790eead4f6)'
        description: Azure Security Center has identified some of your network security
          groups' inbound rules to be too permissive. Inbound rules should not allow
          access from 'Any' or 'Internet' ranges. This can potentially enable attackers
          to target your resources.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_UnprotectedEndpoints_Audit.json)'
        severity: Medium
      - name: '[Internet-facing virtual machines should be protected with network
          security groups](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff6de0be7-9a8a-4b8a-b349-43cf02d22f7c)'
        reference: '[Internet-facing virtual machines should be protected with network
          security groups](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff6de0be7-9a8a-4b8a-b349-43cf02d22f7c)'
        description: Protect your virtual machines from potential threats by restricting
          access to them with network security groups (NSG). Learn more about controlling
          traffic with NSGs at [https://aka.ms/nsg-doc](https://aka.ms/nsg-doc)
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_NetworkSecurityGroupsOnInternetFacingVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Non-internet-facing virtual machines should be protected with network
          security groups](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbb91dfba-c30d-4263-9add-9c2384e659a6)'
        reference: '[Non-internet-facing virtual machines should be protected with
          network security groups](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbb91dfba-c30d-4263-9add-9c2384e659a6)'
        description: Protect your non-internet-facing virtual machines from potential
          threats by restricting access with network security groups (NSG). Learn
          more about controlling traffic with NSGs at [https://aka.ms/nsg-doc](https://aka.ms/nsg-doc)
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_NetworkSecurityGroupsOnInternalVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Subnets should be associated with a Network Security Group](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe71308d3-144b-4262-b144-efdc3cc90517)'
        reference: '[Subnets should be associated with a Network Security Group](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe71308d3-144b-4262-b144-efdc3cc90517)'
        description: Protect your subnet from potential threats by restricting access
          to it with a Network Security Group (NSG). NSGs contain a list of Access
          Control List (ACL) rules that allow or deny network traffic to your subnet.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_NetworkSecurityGroupsOnSubnets_Audit.json)'
        severity: Medium
    - name: Secure cloud services with network controls
      id: Microsoft cloud security benchmark NS-2
      ownership: Shared
      policies:
      - name: '[\[Deprecated\]: Cognitive Services should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcddd188c-4b82-4c48-a19d-ddf74ee66a01)'
        reference: '[\[Deprecated\]: Cognitive Services should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcddd188c-4b82-4c48-a19d-ddf74ee66a01)'
        description: 'Azure Private Link lets you connect your virtual networks to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to Cognitive Services, you''ll reduce the potential for data leakage. Learn
          more about private links at: [https://go.microsoft.com/fwlink/?linkid=2129800](https://go.microsoft.com/fwlink/?linkid=2129800).'
        effects:
        - Audit
        - Disabled
        version: '[3.0.1-deprecated](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cognitive%20Services/EnablePrivateEndpoints_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Storage account public access should be disallowed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4fa4b6c0-31ca-4c0d-b10d-24b96f62a751)'
        reference: '[\[Preview\]: Storage account public access should be disallowed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4fa4b6c0-31ca-4c0d-b10d-24b96f62a751)'
        description: Anonymous public read access to containers and blobs in Azure
          Storage is a convenient way to share data but might present security risks.
          To prevent data breaches caused by undesired anonymous access, Microsoft
          recommends preventing public access to a storage account unless your scenario
          requires it.
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[3.1.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/ASC_Storage_DisallowPublicBlobAccess_Audit.json)'
        severity: High
      - name: '[API Management services should use a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fef619a2c-cc4d-4d03-b2ba-8c94a834d85b)'
        reference: '[API Management services should use a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fef619a2c-cc4d-4d03-b2ba-8c94a834d85b)'
        description: Azure Virtual Network deployment provides enhanced security,
          isolation and allows you to place your API Management service in a non-internet
          routable network that you control access to. These networks can then be
          connected to your on-premises networks using various VPN technologies, which
          enables access to your backend services within the network and/or on-premises.
          The developer portal and API gateway, can be configured to be accessible
          either from the Internet or only within the virtual network.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/VNETEnabled_Audit.json)'
        severity: High
      - name: '[API Management should disable public network access to the service
          configuration endpoints](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdf73bd95-24da-4a4f-96b9-4e8b94b402bd)'
        reference: '[API Management should disable public network access to the service
          configuration endpoints](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdf73bd95-24da-4a4f-96b9-4e8b94b402bd)'
        description: To improve the security of API Management services, restrict
          connectivity to service configuration endpoints, like direct access management
          API, Git configuration management endpoint, or self-hosted gateways configuration
          endpoint.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/PublicEndpoint_AINE.json)'
        severity: Medium
      - name: '[App Configuration should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fca610c1d-041c-4332-9d88-7ed3094967c7)'
        reference: '[App Configuration should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fca610c1d-041c-4332-9d88-7ed3094967c7)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The private link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your app configuration instances instead of the entire service, you''ll
          also be protected against data leakage risks. Learn more at: [https://aka.ms/appconfig/private-endpoint](https://aka.ms/appconfig/private-endpoint).'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Configuration/PrivateLink_Audit.json)'
        severity: Medium
      - name: '[Authorized IP ranges should be defined on Kubernetes Services](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e246bcf-5f6f-4f87-bc6f-775d4712c7ea)'
        reference: '[Authorized IP ranges should be defined on Kubernetes Services](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e246bcf-5f6f-4f87-bc6f-775d4712c7ea)'
        description: Restrict access to the Kubernetes Service Management API by granting
          API access only to IP addresses in specific ranges. It is recommended to
          limit access to authorized IP ranges to ensure that only applications from
          allowed networks can access the cluster.
        effects:
        - Audit
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableIpRanges_KubernetesService_Audit.json)'
        severity: Medium
      - name: '[Azure AI Services resources should restrict network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F037eea7a-bd0a-46c5-9a66-03aea78705d3)'
        reference: '[Azure AI Services resources should restrict network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F037eea7a-bd0a-46c5-9a66-03aea78705d3)'
        description: By restricting network access, you can ensure that only allowed
          networks can access the service. This can be achieved by configuring network
          rules so that only applications from allowed networks can access the Azure
          AI service.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[3.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Ai%20Services/NetworkAcls_Audit.json)'
        severity: High
      - name: '[Azure AI Services resources should use Azure Private Link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd6759c02-b87f-42b7-892e-71b3f471d782)'
        reference: '[Azure AI Services resources should use Azure Private Link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd6759c02-b87f-42b7-892e-71b3f471d782)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform reduces data leakage risks by handling the connectivity
          between the consumer and services over the Azure backbone network. Learn
          more about private links at: [https://aka.ms/AzurePrivateLink/Overview](https://aka.ms/AzurePrivateLink/Overview)'
        effects:
        - Audit
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Ai%20Services/EnablePrivateEndpoints_Audit.json)'
        severity: Medium
      - name: '[Azure Cache for Redis should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7803067c-7d34-46e3-8c79-0ca68fc4036d)'
        reference: '[Azure Cache for Redis should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7803067c-7d34-46e3-8c79-0ca68fc4036d)'
        description: 'Private endpoints lets you connect your virtual network to Azure
          services without a public IP address at the source or destination. By mapping
          private endpoints to your Azure Cache for Redis instances, data leakage
          risks are reduced. Learn more at: [https://docs.microsoft.com/azure/azure-cache-for-redis/cache-private-link](/azure/azure-cache-for-redis/cache-private-link).'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cache/RedisCache_PrivateEndpoint_AINE.json)'
        severity: Medium
      - name: '[Azure Cosmos DB accounts should have firewall rules](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb)'
        reference: '[Azure Cosmos DB accounts should have firewall rules](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb)'
        description: Firewall rules should be defined on your Azure Cosmos DB accounts
          to prevent traffic from unauthorized sources. Accounts that have at least
          one IP rule defined with the virtual network filter enabled are deemed compliant.
          Accounts disabling public access are also deemed compliant.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cosmos%20DB/Cosmos_NetworkRulesExist_Audit.json)'
        severity: High
      - name: '[Azure Cosmos DB should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F797b37f7-06b8-444c-b1ad-fc62867f335a)'
        reference: '[Azure Cosmos DB should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F797b37f7-06b8-444c-b1ad-fc62867f335a)'
        description: 'Disabling public network access improves security by ensuring
          that your CosmosDB account isn''t exposed on the public internet. Creating
          private endpoints can limit exposure of your CosmosDB account. Learn more
          at: [https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation](/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cosmos%20DB/Cosmos_PrivateNetworkAccess_AuditDeny.json)'
        severity: High
      - name: '[Azure Databricks Clusters should disable public IP](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F51c1490f-3319-459c-bbbc-7f391bbed753)'
        reference: '[Azure Databricks Clusters should disable public IP](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F51c1490f-3319-459c-bbbc-7f391bbed753)'
        description: 'Disabling public IP of clusters in Azure Databricks Workspaces
          improves security by ensuring that the clusters aren''t exposed on the public
          internet. Learn more at: [https://learn.microsoft.com/azure/databricks/security/secure-cluster-connectivity](/azure/databricks/security/secure-cluster-connectivity).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Databricks/Databricks_DisablePublicIP_Audit.json)'
        severity: High
      - name: '[Azure Databricks Workspaces should be in a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9c25c9e4-ee12-4882-afd2-11fb9d87893f)'
        reference: '[Azure Databricks Workspaces should be in a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9c25c9e4-ee12-4882-afd2-11fb9d87893f)'
        description: 'Azure Virtual Networks provide enhanced security and isolation
          for your Azure Databricks Workspaces, as well as subnets, access control
          policies, and other features to further restrict access. Learn more at:
          [https://docs.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject](/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Databricks/Databricks_VNETEnabled_Audit.json)'
        severity: High
      - name: '[Azure Databricks Workspaces should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e7849de-b939-4c50-ab48-fc6b0f5eeba2)'
        reference: '[Azure Databricks Workspaces should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e7849de-b939-4c50-ab48-fc6b0f5eeba2)'
        description: 'Disabling public network access improves security by ensuring
          that the resource isn''t exposed on the public internet. You can control
          exposure of your resources by creating private endpoints instead. Learn
          more at: [https://learn.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/private-link](/azure/databricks/administration-guide/cloud-configurations/azure/private-link).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Databricks/Databricks_AuditPublicNetworkAccess.json)'
        severity: High
      - name: '[Azure Databricks Workspaces should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F258823f2-4595-4b52-b333-cc96192710d8)'
        reference: '[Azure Databricks Workspaces should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F258823f2-4595-4b52-b333-cc96192710d8)'
        description: 'Azure Private Link lets you connect your virtual networks to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to Azure Databricks workspaces, you can reduce data leakage risks. Learn
          more about private links at: [https://aka.ms/adbpe](https://aka.ms/adbpe).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Databricks/Databricks_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Azure Event Grid domains should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9830b652-8523-49cc-b1b3-e17dce1127ca)'
        reference: '[Azure Event Grid domains should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9830b652-8523-49cc-b1b3-e17dce1127ca)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your Event Grid domain instead of the entire service, you''ll also be
          protected against data leakage risks. Learn more at: [https://aka.ms/privateendpoints](https://aka.ms/privateendpoints).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Event%20Grid/Domains_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Azure Event Grid topics should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4b90e17e-8448-49db-875e-bd83fb6f804f)'
        reference: '[Azure Event Grid topics should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4b90e17e-8448-49db-875e-bd83fb6f804f)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your Event Grid topic instead of the entire service, you''ll also be
          protected against data leakage risks. Learn more at: [https://aka.ms/privateendpoints](https://aka.ms/privateendpoints).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Event%20Grid/Topics_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Azure Key Vault should have firewall enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F55615ac9-af46-4a59-874e-391cc3dfb490)'
        reference: '[Azure Key Vault should have firewall enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F55615ac9-af46-4a59-874e-391cc3dfb490)'
        description: 'Enable the key vault firewall so that the key vault is not accessible
          by default to any public IPs. Optionally, you can configure specific IP
          ranges to limit access to those networks. Learn more at: [https://docs.microsoft.com/azure/key-vault/general/network-security](/azure/key-vault/general/network-security)'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[3.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/FirewallEnabled_Audit.json)'
        severity: High
      - name: '[Azure Key Vaults should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6abeaec-4d90-4a02-805f-6b26c4d3fbe9)'
        reference: '[Azure Key Vaults should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6abeaec-4d90-4a02-805f-6b26c4d3fbe9)'
        description: 'Azure Private Link lets you connect your virtual networks to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to key vault, you can reduce data leakage risks. Learn more about private
          links at: [https://aka.ms/akvprivatelink](https://aka.ms/akvprivatelink).'
        effects:
        - '[parameters(''audit_effect'')]'
        version: '[1.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Should_Use_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Azure Machine Learning Computes should be in a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7804b5c7-01dc-4723-969b-ae300cc07ff1)'
        reference: '[Azure Machine Learning Computes should be in a virtual network](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7804b5c7-01dc-4723-969b-ae300cc07ff1)'
        description: Azure Virtual Networks provide enhanced security and isolation
          for your Azure Machine Learning Compute Clusters and Instances, as well
          as subnets, access control policies, and other features to further restrict
          access. When a compute is configured with a virtual network, it is not publicly
          addressable and can only be accessed from virtual machines and applications
          within the virtual network.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/Vnet_Audit.json)'
        severity: Medium
      - name: '[Azure Machine Learning Workspaces should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F438c38d2-3772-465a-a9cc-7a6666a275ce)'
        reference: '[Azure Machine Learning Workspaces should disable public network
          access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F438c38d2-3772-465a-a9cc-7a6666a275ce)'
        description: 'Disabling public network access improves security by ensuring
          that the Machine Learning Workspaces aren''t exposed on the public internet.
          You can control exposure of your workspaces by creating private endpoints
          instead. Learn more at: [https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=azure-portal](/azure/machine-learning/how-to-configure-private-link).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/Workspace_PublicNetworkAccessDisabled_Audit.json)'
        severity: High
      - name: '[Azure Machine Learning workspaces should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F45e05259-1eb5-4f70-9574-baf73e9d219b)'
        reference: '[Azure Machine Learning workspaces should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F45e05259-1eb5-4f70-9574-baf73e9d219b)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to Azure Machine Learning workspaces, data leakage risks are reduced. Learn
          more about private links at: [https://docs.microsoft.com/azure/machine-learning/how-to-configure-private-link](/azure/machine-learning/how-to-configure-private-link).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/Workspace_PrivateEndpoint_Audit_V2.json)'
        severity: Medium
      - name: '[Azure SignalR Service should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2393d2cf-a342-44cd-a2e2-fe0188fd1234)'
        reference: '[Azure SignalR Service should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2393d2cf-a342-44cd-a2e2-fe0188fd1234)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The private link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your Azure SignalR Service resource instead of the entire service, you''ll
          reduce your data leakage risks. Learn more about private links at: [https://aka.ms/asrs/privatelink](https://aka.ms/asrs/privatelink).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SignalR/PrivateEndpointEnabled_Audit_v2.json)'
        severity: Medium
      - name: '[Azure Spring Cloud should use network injection](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Faf35e2a4-ef96-44e7-a9ae-853dd97032c4)'
        reference: '[Azure Spring Cloud should use network injection](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Faf35e2a4-ef96-44e7-a9ae-853dd97032c4)'
        description: 'Azure Spring Cloud instances should use virtual network injection
          for the following purposes: 1. Isolate Azure Spring Cloud from Internet.
          2. Enable Azure Spring Cloud to interact with systems in either on premises
          data centers or Azure service in other virtual networks. 3. Empower customers
          to control inbound and outbound network communications for Azure Spring
          Cloud.'
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Platform/Spring_VNETEnabled_Audit.json)'
        severity: High
      - name: '[Azure SQL Managed Instances should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9dfea752-dd46-4766-aed1-c355fa93fb91)'
        reference: '[Azure SQL Managed Instances should disable public network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9dfea752-dd46-4766-aed1-c355fa93fb91)'
        description: Disabling public network access (public endpoint) on Azure SQL
          Managed Instances improves security by ensuring that they can only be accessed
          from inside their virtual networks or via Private Endpoints. To learn more
          about public network access, visit [https://aka.ms/mi-public-endpoint](https://aka.ms/mi-public-endpoint).
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_PublicEndpoint_Audit.json)'
        severity: High
      - name: '[Container registries should not allow unrestricted network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd0793b48-0edc-4296-a390-4c75d1bdfd71)'
        reference: '[Container registries should not allow unrestricted network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd0793b48-0edc-4296-a390-4c75d1bdfd71)'
        description: 'Azure container registries by default accept connections over
          the internet from hosts on any network. To protect your registries from
          potential threats, allow access from only specific private endpoints, public
          IP addresses or address ranges. If your registry doesn''t have network rules
          configured, it will appear in the unhealthy resources. Learn more about
          Container Registry network rules here: [https://aka.ms/acr/privatelink,](https://aka.ms/acr/privatelink,)
          [https://aka.ms/acr/portal/public-network](https://aka.ms/acr/portal/public-network)
          and [https://aka.ms/acr/vnet](https://aka.ms/acr/vnet).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Container%20Registry/ACR_NetworkRulesExist_AuditDeny.json)'
        severity: High
      - name: '[Container registries should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe8eef0a8-67cf-4eb4-9386-14b0e78733d4)'
        reference: '[Container registries should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe8eef0a8-67cf-4eb4-9386-14b0e78733d4)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The private link platform handles the connectivity between the consumer
          and services over the Azure backbone network.By mapping private endpoints
          to your container registries instead of the entire service, you''ll also
          be protected against data leakage risks. Learn more at: [https://aka.ms/acr/private-link](https://aka.ms/acr/private-link).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Container%20Registry/ACR_PrivateEndpointEnabled_Audit.json)'
        severity: Medium
      - name: '[CosmosDB accounts should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F58440f8a-10c5-4151-bdce-dfbaad4a20b7)'
        reference: '[CosmosDB accounts should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F58440f8a-10c5-4151-bdce-dfbaad4a20b7)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your CosmosDB account, data leakage risks are reduced. Learn more about
          private links at: [https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints](/azure/cosmos-db/how-to-configure-private-endpoints).'
        effects:
        - Audit
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cosmos%20DB/Cosmos_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Private endpoint connections on Azure SQL Database should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7698e800-9299-47a6-b3b6-5a0fee576eed)'
        reference: '[Private endpoint connections on Azure SQL Database should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7698e800-9299-47a6-b3b6-5a0fee576eed)'
        description: Private endpoint connections enforce secure communication by
          enabling private connectivity to Azure SQL Database.
        effects:
        - Audit
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Private endpoint should be enabled for MariaDB servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a1302fb-a631-4106-9753-f3d494733990)'
        reference: '[Private endpoint should be enabled for MariaDB servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a1302fb-a631-4106-9753-f3d494733990)'
        description: Private endpoint connections enforce secure communication by
          enabling private connectivity to Azure Database for MariaDB. Configure a
          private endpoint connection to enable access to traffic coming only from
          known networks and prevent access from all other IP addresses, including
          within Azure.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MariaDB_EnablePrivateEndPoint_Audit.json)'
        severity: Medium
      - name: '[Private endpoint should be enabled for MySQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7595c971-233d-4bcf-bd18-596129188c49)'
        reference: '[Private endpoint should be enabled for MySQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7595c971-233d-4bcf-bd18-596129188c49)'
        description: Private endpoint connections enforce secure communication by
          enabling private connectivity to Azure Database for MySQL. Configure a private
          endpoint connection to enable access to traffic coming only from known networks
          and prevent access from all other IP addresses, including within Azure.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_EnablePrivateEndPoint_Audit.json)'
        severity: Medium
      - name: '[Private endpoint should be enabled for PostgreSQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0564d078-92f5-4f97-8398-b9f58a51f70b)'
        reference: '[Private endpoint should be enabled for PostgreSQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0564d078-92f5-4f97-8398-b9f58a51f70b)'
        description: Private endpoint connections enforce secure communication by
          enabling private connectivity to Azure Database for PostgreSQL. Configure
          a private endpoint connection to enable access to traffic coming only from
          known networks and prevent access from all other IP addresses, including
          within Azure.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_EnablePrivateEndPoint_Audit.json)'
        severity: Medium
      - name: '[Public network access on Azure SQL Database should be disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b8ca024-1d5c-4dec-8995-b1a932b41780)'
        reference: '[Public network access on Azure SQL Database should be disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b8ca024-1d5c-4dec-8995-b1a932b41780)'
        description: Disabling the public network access property improves security
          by ensuring your Azure SQL Database can only be accessed from a private
          endpoint. This configuration denies all logins that match IP or virtual
          network based firewall rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_PublicNetworkAccess_Audit.json)'
        severity: High
      - name: '[Public network access should be disabled for MariaDB servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffdccbe47-f3e3-4213-ad5d-ea459b2fa077)'
        reference: '[Public network access should be disabled for MariaDB servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffdccbe47-f3e3-4213-ad5d-ea459b2fa077)'
        description: Disable the public network access property to improve security
          and ensure your Azure Database for MariaDB can only be accessed from a private
          endpoint. This configuration strictly disables access from any public address
          space outside of Azure IP range, and denies all logins that match IP or
          virtual network-based firewall rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MariaDB_DisablePublicNetworkAccess_Audit.json)'
        severity: High
      - name: '[Public network access should be disabled for MySQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd9844e8a-1437-4aeb-a32c-0c992f056095)'
        reference: '[Public network access should be disabled for MySQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd9844e8a-1437-4aeb-a32c-0c992f056095)'
        description: Disable the public network access property to improve security
          and ensure your Azure Database for MySQL can only be accessed from a private
          endpoint. This configuration strictly disables access from any public address
          space outside of Azure IP range, and denies all logins that match IP or
          virtual network-based firewall rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_DisablePublicNetworkAccess_Audit.json)'
        severity: High
      - name: '[Public network access should be disabled for PostgreSQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb52376f7-9612-48a1-81cd-1ffe4b61032c)'
        reference: '[Public network access should be disabled for PostgreSQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb52376f7-9612-48a1-81cd-1ffe4b61032c)'
        description: Disable the public network access property to improve security
          and ensure your Azure Database for PostgreSQL can only be accessed from
          a private endpoint. This configuration disables access from any public address
          space outside of Azure IP range, and denies all logins that match IP or
          virtual network-based firewall rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_DisablePublicNetworkAccess_Audit.json)'
        severity: High
      - name: '[Storage accounts should restrict network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F34c877ad-507e-4c82-993e-3452a6e0ad3c)'
        reference: '[Storage accounts should restrict network access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F34c877ad-507e-4c82-993e-3452a6e0ad3c)'
        description: Network access to storage accounts should be restricted. Configure
          network rules so only applications from allowed networks can access the
          storage account. To allow connections from specific internet or on-premises
          clients, access can be granted to traffic from specific Azure virtual networks
          or to public internet IP address ranges
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/Storage_NetworkAcls_Audit.json)'
        severity: High
      - name: '[Storage accounts should restrict network access using virtual network
          rules](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2a1a9cdf-e04d-429a-8416-3bfb72a1b26f)'
        reference: '[Storage accounts should restrict network access using virtual
          network rules](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2a1a9cdf-e04d-429a-8416-3bfb72a1b26f)'
        description: Protect your storage accounts from potential threats using virtual
          network rules as a preferred method instead of IP-based filtering. Disabling
          IP-based filtering prevents public IPs from accessing your storage accounts.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/StorageAccountOnlyVnetRulesEnabled_Audit.json)'
        severity: High
      - name: '[Storage accounts should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6edd7eda-6dd8-40f7-810d-67160c639cd9)'
        reference: '[Storage accounts should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6edd7eda-6dd8-40f7-810d-67160c639cd9)'
        description: Azure Private Link lets you connect your virtual network to Azure
          services without a public IP address at the source or destination. The Private
          Link platform handles the connectivity between the consumer and services
          over the Azure backbone network. By mapping private endpoints to your storage
          account, data leakage risks are reduced. Learn more about private links
          at - [https://aka.ms/azureprivatelinkoverview](https://aka.ms/azureprivatelinkoverview)
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/StorageAccountPrivateEndpointEnabled_Audit.json)'
        severity: Medium
      - name: '[VM Image Builder templates should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2154edb9-244f-4741-9970-660785bccdaa)'
        reference: '[VM Image Builder templates should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2154edb9-244f-4741-9970-660785bccdaa)'
        description: 'Azure Private Link lets you connect your virtual network to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to your VM Image Builder building resources, data leakage risks are reduced.
          Learn more about private links at: [https://docs.microsoft.com/azure/virtual-machines/linux/image-builder-networking#deploy-using-an-existing-vnet](/azure/virtual-machines/linux/image-builder-networking#deploy-using-an-existing-vnet).'
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/VM%20Image%20Builder/PrivateLinkEnabled_Audit.json)'
        severity: High
    - name: Deploy firewall at the edge of enterprise network
      id: Microsoft cloud security benchmark NS-3
      ownership: Shared
      policies:
      - name: '[\[Preview\]: All Internet traffic should be routed via your deployed
          Azure Firewall](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc5e4038-4584-4632-8c85-c0448d374b2c)'
        reference: '[\[Preview\]: All Internet traffic should be routed via your deployed
          Azure Firewall](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc5e4038-4584-4632-8c85-c0448d374b2c)'
        description: Azure Security Center has identified that some of your subnets
          aren't protected with a next generation firewall. Protect your subnets from
          potential threats by restricting access to them with Azure Firewall or a
          supported next generation firewall
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Network/ASC_All_Internet_traffic_should_be_routed_via_Azure_Firewall.json)'
        severity: Medium
      - name: '[IP Forwarding on your virtual machine should be disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbd352bd5-2853-4985-bf0d-73806b4a5744)'
        reference: '[IP Forwarding on your virtual machine should be disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbd352bd5-2853-4985-bf0d-73806b4a5744)'
        description: Enabling IP forwarding on a virtual machine's NIC allows the
          machine to receive traffic addressed to other destinations. IP forwarding
          is rarely required (e.g., when using the VM as a network virtual appliance),
          and therefore, this should be reviewed by the network security team.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_IPForwardingOnVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Management ports of virtual machines should be protected with just-in-time
          network access control](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb0f33259-77d7-4c9e-aac6-3aabcfae693c)'
        reference: '[Management ports of virtual machines should be protected with
          just-in-time network access control](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb0f33259-77d7-4c9e-aac6-3aabcfae693c)'
        description: Possible network Just In Time (JIT) access will be monitored
          by Azure Security Center as recommendations
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_JITNetworkAccess_Audit.json)'
        severity: Medium
      - name: '[Management ports should be closed on your virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F22730e10-96f6-4aac-ad84-9383d35b5917)'
        reference: '[Management ports should be closed on your virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F22730e10-96f6-4aac-ad84-9383d35b5917)'
        description: Open remote management ports are exposing your VM to a high level
          of risk from Internet-based attacks. These attacks attempt to brute force
          credentials to gain admin access to the machine.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_OpenManagementPortsOnVirtualMachines_Audit.json)'
        severity: Medium
    - name: Deploy DDOS protection
      id: Microsoft cloud security benchmark NS-5
      ownership: Shared
      policies:
      - name: '[Azure DDoS Protection should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa7aca53f-2ed4-4466-a25e-0b45ade68efd)'
        reference: '[Azure DDoS Protection should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa7aca53f-2ed4-4466-a25e-0b45ade68efd)'
        description: DDoS protection should be enabled for all virtual networks with
          a subnet that is part of an application gateway with a public IP.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDDoSProtection_Audit.json)'
        severity: Medium
    - name: Deploy web application firewall
      id: Microsoft cloud security benchmark NS-6
      ownership: Shared
      policies:
      - name: '[Azure Web Application Firewall should be enabled for Azure Front Door
          entry-points](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F055aa869-bc98-4af8-bafc-23f1ab6ffe2c)'
        reference: '[Azure Web Application Firewall should be enabled for Azure Front
          Door entry-points](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F055aa869-bc98-4af8-bafc-23f1ab6ffe2c)'
        description: Deploy Azure Web Application Firewall (WAF) in front of public
          facing web applications for additional inspection of incoming traffic. Web
          Application Firewall (WAF) provides centralized protection of your web applications
          from common exploits and vulnerabilities such as SQL injections, Cross-Site
          Scripting, local and remote file executions. You can also restrict access
          to your web applications by countries, IP address ranges, and other http(s)
          parameters via custom rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Network/WAF_AFD_Enabled_Audit.json)'
        severity: High
      - name: '[Web Application Firewall (WAF) should be enabled for Application Gateway](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F564feb30-bf6a-4854-b4bb-0d2d2d1e6c66)'
        reference: '[Web Application Firewall (WAF) should be enabled for Application
          Gateway](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F564feb30-bf6a-4854-b4bb-0d2d2d1e6c66)'
        description: Deploy Azure Web Application Firewall (WAF) in front of public
          facing web applications for additional inspection of incoming traffic. Web
          Application Firewall (WAF) provides centralized protection of your web applications
          from common exploits and vulnerabilities such as SQL injections, Cross-Site
          Scripting, local and remote file executions. You can also restrict access
          to your web applications by countries, IP address ranges, and other http(s)
          parameters via custom rules.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Network/WAF_AppGatewayEnabled_Audit.json)'
        severity: High
    - name: Detect and disable insecure services and protocols
      id: Microsoft cloud security benchmark NS-8
      ownership: Shared
      policies:
      - name: '[App Service apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b)'
        reference: '[App Service apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b)'
        description: Periodically, newer versions are released for TLS either due
          to security flaws, include additional functionality, and enhance speed.
          Upgrade to the latest TLS version for App Service apps to take advantage
          of security fixes, if any, and/or new functionalities of the latest version.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RequireLatestTls_WebApp_Audit.json)'
        severity: Medium
      - name: '[Function apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9d614c5-c173-4d56-95a7-b4437057d193)'
        reference: '[Function apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9d614c5-c173-4d56-95a7-b4437057d193)'
        description: Periodically, newer versions are released for TLS either due
          to security flaws, include additional functionality, and enhance speed.
          Upgrade to the latest TLS version for Function apps to take advantage of
          security fixes, if any, and/or new functionalities of the latest version.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RequireLatestTls_FunctionApp_Audit.json)'
        severity: Medium
  - name: Identity Management
    subcategories:
    - name: Use centralized identity and authentication system
      id: Microsoft cloud security benchmark IM-1
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Azure PostgreSQL flexible server should have Microsoft
          Entra Only Authentication enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffa498b91-8a7e-4710-9578-da944c68d1fe)'
        reference: '[\[Preview\]: Azure PostgreSQL flexible server should have Microsoft
          Entra Only Authentication enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffa498b91-8a7e-4710-9578-da944c68d1fe)'
        description: Disabling local authentication methods and allowing only Microsoft
          Entra Authentication improves security by ensuring that Azure PostgreSQL
          flexible server can exclusively be accessed by Microsoft Entra identities.
        effects:
        - Audit
        - Disabled
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_FlexibleServers_EnableEntraOnlyAuthentication_Audit.json)'
        severity: Medium
      - name: '[A Microsoft Entra administrator should be provisioned for PostgreSQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb4dec045-250a-48c2-b5cc-e0c4eec8b5b4)'
        reference: '[A Microsoft Entra administrator should be provisioned for PostgreSQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb4dec045-250a-48c2-b5cc-e0c4eec8b5b4)'
        description: Audit provisioning of a Microsoft Entra administrator for your
          PostgreSQL server to enable Microsoft Entra authentication. Microsoft Entra
          authentication enables simplified permission management and centralized
          identity management of database users and other Microsoft services
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_AuditServerADAdmins_Audit.json)'
        severity: Medium
      - name: '[An Azure Active Directory administrator should be provisioned for
          SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f314764-cb73-4fc9-b863-8eca98ac36e9)'
        reference: '[An Azure Active Directory administrator should be provisioned
          for SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f314764-cb73-4fc9-b863-8eca98ac36e9)'
        description: Audit provisioning of an Azure Active Directory administrator
          for your SQL server to enable Azure AD authentication. Azure AD authentication
          enables simplified permission management and centralized identity management
          of database users and other Microsoft services
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SQL_DB_AuditServerADAdmins_Audit.json)'
        severity: Medium
      - name: '[Azure AI Services resources should have key access disabled (disable
          local authentication)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F71ef260a-8f18-47b7-abcb-62d0673d94dc)'
        reference: '[Azure AI Services resources should have key access disabled (disable
          local authentication)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F71ef260a-8f18-47b7-abcb-62d0673d94dc)'
        description: 'Key access (local authentication) is recommended to be disabled
          for security. Azure OpenAI Studio, typically used in development/testing,
          requires key access and will not function if key access is disabled. After
          disabling, Microsoft Entra ID becomes the only access method, which allows
          maintaining minimum privilege principle and granular control. Learn more
          at: [https://aka.ms/AI/auth](https://aka.ms/AI/auth)'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Ai%20Services/DisableLocalAuth_Audit.json)'
        severity: High
      - name: '[Azure Machine Learning Computes should have local authentication methods
          disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe96a9a5f-07ca-471b-9bc5-6a0f33cbd68f)'
        reference: '[Azure Machine Learning Computes should have local authentication
          methods disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe96a9a5f-07ca-471b-9bc5-6a0f33cbd68f)'
        description: 'Disabling local authentication methods improves security by
          ensuring that Machine Learning Computes require Azure Active Directory identities
          exclusively for authentication. Learn more at: [https://aka.ms/azure-ml-aad-policy](https://aka.ms/azure-ml-aad-policy).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/DisableLocalAuth_Audit.json)'
        severity: High
      - name: '[Azure SQL Database should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb3a22bc9-66de-45fb-98fa-00f5df42f41a)'
        reference: '[Azure SQL Database should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb3a22bc9-66de-45fb-98fa-00f5df42f41a)'
        description: 'Require Azure SQL logical servers to use Microsoft Entra-only
          authentication. This policy doesn''t block servers from being created with
          local authentication enabled. It does block local authentication from being
          enabled on resources after create. Consider using the ''Microsoft Entra-only
          authentication'' initiative instead to require both. Learn more at: [https://aka.ms/adonlycreate](https://aka.ms/adonlycreate).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_ADOnlyEnabled_DisableADAuth_Deny.json)'
        severity: High
      - name: '[Azure SQL Database should have Microsoft Entra-only authentication
          enabled during creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabda6d70-9778-44e7-84a8-06713e6db027)'
        reference: '[Azure SQL Database should have Microsoft Entra-only authentication
          enabled during creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabda6d70-9778-44e7-84a8-06713e6db027)'
        description: 'Require Azure SQL logical servers to be created with Microsoft
          Entra-only authentication. This policy doesn''t block local authentication
          from being re-enabled on resources after create. Consider using the ''Microsoft
          Entra-only authentication'' initiative instead to require both. Learn more
          at: [https://aka.ms/adonlycreate](https://aka.ms/adonlycreate).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_ADOnlyEnabled_Deny.json)'
        severity: High
      - name: '[Azure SQL Managed Instance should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0c28c3fb-c244-42d5-a9bf-f35f2999577b)'
        reference: '[Azure SQL Managed Instance should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0c28c3fb-c244-42d5-a9bf-f35f2999577b)'
        description: 'Require Azure SQL Managed Instance to use Microsoft Entra-only
          authentication. This policy doesn''t block Azure SQL Managed instances from
          being created with local authentication enabled. It does block local authentication
          from being enabled on resources after create. Consider using the ''Microsoft
          Entra-only authentication'' initiative instead to require both. Learn more
          at: [https://aka.ms/adonlycreate](https://aka.ms/adonlycreate).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_ADOnlyEnabled_DisableADAuth_Deny.json)'
        severity: High
      - name: '[Azure SQL Managed Instances should have Microsoft Entra-only authentication
          enabled during creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F78215662-041e-49ed-a9dd-5385911b3a1f)'
        reference: '[Azure SQL Managed Instances should have Microsoft Entra-only
          authentication enabled during creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F78215662-041e-49ed-a9dd-5385911b3a1f)'
        description: 'Require Azure SQL Managed Instance to be created with Microsoft
          Entra-only authentication. This policy doesn''t block local authentication
          from being re-enabled on resources after create. Consider using the ''Microsoft
          Entra-only authentication'' initiative instead to require both. Learn more
          at: [https://aka.ms/adonlycreate](https://aka.ms/adonlycreate).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_ADOnlyEnabled_Deny.json)'
        severity: High
      - name: '[Cosmos DB database accounts should have local authentication methods
          disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5450f5bd-9c72-4390-a9c4-a7aba4edfdd2)'
        reference: '[Cosmos DB database accounts should have local authentication
          methods disabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5450f5bd-9c72-4390-a9c4-a7aba4edfdd2)'
        description: 'Disabling local authentication methods improves security by
          ensuring that Cosmos DB database accounts exclusively require Azure Active
          Directory identities for authentication. Learn more at: [https://docs.microsoft.com/azure/cosmos-db/how-to-setup-rbac#disable-local-auth](/azure/cosmos-db/how-to-setup-rbac#disable-local-auth).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cosmos%20DB/Cosmos_DisableLocalAuth_AuditDeny.json)'
        severity: High
      - name: '[Service Fabric clusters should only use Azure Active Directory for
          client authentication](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb54ed75b-3e1a-44ac-a333-05ba39b99ff0)'
        reference: '[Service Fabric clusters should only use Azure Active Directory
          for client authentication](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb54ed75b-3e1a-44ac-a333-05ba39b99ff0)'
        description: Audit usage of client authentication only via Azure Active Directory
          in Service Fabric
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Service%20Fabric/AuditADAuth_Audit.json)'
        severity: High
      - name: '[Storage accounts should prevent shared key access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54)'
        reference: '[Storage accounts should prevent shared key access](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54)'
        description: Audit requirement of Azure Active Directory (Azure AD) to authorize
          requests for your storage account. By default, requests can be authorized
          with either Azure Active Directory credentials, or by using the account
          access key for Shared Key authorization. Of these two types of authorization,
          Azure AD provides superior security and ease of use over Shared Key, and
          is recommended by Microsoft.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/StorageAccountAllowSharedKeyAccess_Audit.json)'
        severity: High
      - name: '[Synapse Workspaces should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6ea81a52-5ca7-4575-9669-eaa910b7edf8)'
        reference: '[Synapse Workspaces should have Microsoft Entra-only authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6ea81a52-5ca7-4575-9669-eaa910b7edf8)'
        description: 'Require Synapse Workspaces to use Microsoft Entra-only authentication.
          This policy doesn''t block workspaces from being created with local authentication
          enabled. It does block local authentication from being enabled on resources
          after create. Consider using the ''Microsoft Entra-only authentication''
          initiative instead to require both. Learn more at: [https://aka.ms/Synapse](https://aka.ms/Synapse).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Synapse/WorkspaceDisableAadOnlyAuthentication_Audit.json)'
        severity: High
      - name: '[Synapse Workspaces should use only Microsoft Entra identities for
          authentication during workspace creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2158ddbe-fefa-408e-b43f-d4faef8ff3b8)'
        reference: '[Synapse Workspaces should use only Microsoft Entra identities
          for authentication during workspace creation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2158ddbe-fefa-408e-b43f-d4faef8ff3b8)'
        description: 'Require Synapse Workspaces to be created with Microsoft Entra-only
          authentication. This policy doesn''t block local authentication from being
          re-enabled on resources after create. Consider using the ''Microsoft Entra-only
          authentication'' initiative instead to require both. Learn more at: [https://aka.ms/Synapse](https://aka.ms/Synapse).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Synapse/SynaspeWorkspaceAadOnlyAuthentication_Audit.json)'
        severity: High
      - name: '[VPN gateways should use only Azure Active Directory (Azure AD) authentication
          for point-to-site users](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F21a6bc25-125e-4d13-b82d-2e19b7208ab7)'
        reference: '[VPN gateways should use only Azure Active Directory (Azure AD)
          authentication for point-to-site users](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F21a6bc25-125e-4d13-b82d-2e19b7208ab7)'
        description: Disabling local authentication methods improves security by ensuring
          that VPN Gateways use only Azure Active Directory identities for authentication.
          Learn more about Azure AD authentication at [https://docs.microsoft.com/azure/vpn-gateway/openvpn-azure-ad-tenant](/azure/vpn-gateway/openvpn-azure-ad-tenant)
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Network/VPN-AzureAD-audit-deny-disable-policy.json)'
        severity: High
    - name: Manage application identities securely and automatically
      id: Microsoft cloud security benchmark IM-3
      ownership: Shared
      policies:
      - name: '[App Service apps should use managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2b9ad585-36bc-4615-b300-fd4435808332)'
        reference: '[App Service apps should use managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2b9ad585-36bc-4615-b300-fd4435808332)'
        description: Use a managed identity for enhanced authentication security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/UseManagedIdentity_WebApp_Audit.json)'
        severity: Medium
      - name: '[Function apps should use managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0da106f2-4ca3-48e8-bc85-c638fe6aea8f)'
        reference: '[Function apps should use managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0da106f2-4ca3-48e8-bc85-c638fe6aea8f)'
        description: Use a managed identity for enhanced authentication security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/UseManagedIdentity_FunctionApp_Audit.json)'
        severity: Medium
      - name: '[Virtual machines'' Guest Configuration extension should be deployed
          with system-assigned managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd26f7642-7545-4e18-9b75-8c9bbdee3a9a)'
        reference: '[Virtual machines'' Guest Configuration extension should be deployed
          with system-assigned managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd26f7642-7545-4e18-9b75-8c9bbdee3a9a)'
        description: The Guest Configuration extension requires a system assigned
          managed identity. Azure virtual machines in the scope of this policy will
          be non-compliant when they have the Guest Configuration extension installed
          but do not have a system assigned managed identity. Learn more at [https://aka.ms/gcpol](https://aka.ms/gcpol)
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_GCExtOnVmWithNoSAMI.json)'
        severity: Medium
    - name: Authenticate server and services
      id: Microsoft cloud security benchmark IM-4
      ownership: Shared
      policies:
      - name: '[API endpoints in Azure API Management should be authenticated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8ac833bd-f505-48d5-887e-c993a1d3eea0)'
        reference: '[API endpoints in Azure API Management should be authenticated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8ac833bd-f505-48d5-887e-c993a1d3eea0)'
        description: 'API endpoints published within Azure API Management should enforce
          authentication to help minimize security risk. Authentication mechanisms
          are sometimes implemented incorrectly or are missing. This allows attackers
          to exploit implementation flaws and to access data. Learn More about the
          OWASP API Threat for Broken User Authentication here: [https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats#broken-user-authentication](/azure/api-management/mitigate-owasp-api-threats#broken-user-authentication)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_APIMApiEndpointsShouldbeAuthenticated_AINE.json)'
        severity: Medium
      - name: '[API Management calls to API backends should be authenticated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc15dcc82-b93c-4dcb-9332-fbf121685b54)'
        reference: '[API Management calls to API backends should be authenticated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc15dcc82-b93c-4dcb-9332-fbf121685b54)'
        description: Calls from API Management to backends should use some form of
          authentication, whether via certificates or credentials. Does not apply
          to Service Fabric backends.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/BackendAuth_AuditDeny.json)'
        severity: High
      - name: '[API Management calls to API backends should not bypass certificate
          thumbprint or name validation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F92bb331d-ac71-416a-8c91-02f2cb734ce4)'
        reference: '[API Management calls to API backends should not bypass certificate
          thumbprint or name validation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F92bb331d-ac71-416a-8c91-02f2cb734ce4)'
        description: To improve the API security, API Management should validate the
          backend server certificate for all API calls. Enable SSL certificate thumbprint
          and name validation.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/BackendCertificateChecks_AuditDeny.json)'
        severity: High
      - name: '[Azure SQL Database should be running TLS version 1.2 or newer](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F32e6bbec-16b6-44c2-be37-c5b672d103cf)'
        reference: '[Azure SQL Database should be running TLS version 1.2 or newer](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F32e6bbec-16b6-44c2-be37-c5b672d103cf)'
        description: Setting TLS version to 1.2 or newer improves security by ensuring
          your Azure SQL Database can only be accessed from clients using TLS 1.2
          or newer. Using versions of TLS less than 1.2 is not recommended since they
          have well documented security vulnerabilities.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_MiniumTLSVersion_Audit.json)'
        severity: High
    - name: Use strong authentication controls
      id: Microsoft cloud security benchmark IM-6
      ownership: Shared
      policies:
      - name: '[Accounts with owner permissions on Azure resources should be MFA enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe3e008c3-56b9-4133-8fd7-d3347377402a)'
        reference: '[Accounts with owner permissions on Azure resources should be
          MFA enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe3e008c3-56b9-4133-8fd7-d3347377402a)'
        description: Multi-Factor Authentication (MFA) should be enabled for all subscription
          accounts with owner permissions to prevent a breach of accounts or resources.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableMFAForAccountsWithOwnerPermissions_Audit.json)'
        severity: Medium
      - name: '[Accounts with read permissions on Azure resources should be MFA enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F81b3ccb4-e6e8-4e4a-8d05-5df25cd29fd4)'
        reference: '[Accounts with read permissions on Azure resources should be MFA
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F81b3ccb4-e6e8-4e4a-8d05-5df25cd29fd4)'
        description: Multi-Factor Authentication (MFA) should be enabled for all subscription
          accounts with read privileges to prevent a breach of accounts or resources.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableMFAForAccountsWithReadPermissions_Audit.json)'
        severity: Medium
      - name: '[Accounts with write permissions on Azure resources should be MFA enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F931e118d-50a1-4457-a5e4-78550e086c52)'
        reference: '[Accounts with write permissions on Azure resources should be
          MFA enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F931e118d-50a1-4457-a5e4-78550e086c52)'
        description: Multi-Factor Authentication (MFA) should be enabled for all subscription
          accounts with write privileges to prevent a breach of accounts or resources.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableMFAForAccountsWithWritePermissions_Audit.json)'
        severity: Medium
      - name: '[Authentication to Linux machines should require SSH keys](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F630c64f9-8b6b-4c64-b511-6544ceff6fd6)'
        reference: '[Authentication to Linux machines should require SSH keys](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F630c64f9-8b6b-4c64-b511-6544ceff6fd6)'
        description: 'Although SSH itself provides an encrypted connection, using
          passwords with SSH still leaves the VM vulnerable to brute-force attacks.
          The most secure option for authenticating to an Azure Linux virtual machine
          over SSH is with a public-private key pair, also known as SSH keys. Learn
          more: [https://docs.microsoft.com/azure/virtual-machines/linux/create-ssh-keys-detailed](/azure/virtual-machines/linux/create-ssh-keys-detailed).'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/LinuxNoPasswordForSSH_AINE.json)'
        severity: Medium
    - name: Restrict the exposure of credential and secrets
      id: Microsoft cloud security benchmark IM-8
      ownership: Shared
      policies:
      - name: '[API Management minimum API version should be set to 2019-12-01 or
          higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F549814b6-3212-4203-bdc8-1548d342fb67)'
        reference: '[API Management minimum API version should be set to 2019-12-01
          or higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F549814b6-3212-4203-bdc8-1548d342fb67)'
        description: To prevent service secrets from being shared with read-only users,
          the minimum API version should be set to 2019-12-01 or higher.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/MinimumApiVersion_AuditDeny.json)'
        severity: High
      - name: '[API Management secret named values should be stored in Azure Key Vault](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff1cc7827-022c-473e-836e-5a51cae0b249)'
        reference: '[API Management secret named values should be stored in Azure
          Key Vault](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff1cc7827-022c-473e-836e-5a51cae0b249)'
        description: Named values are a collection of name and value pairs in each
          API Management service. Secret values can be stored either as encrypted
          text in API Management (custom secrets) or by referencing secrets in Azure
          Key Vault. To improve security of API Management and secrets, reference
          secret named values from Azure Key Vault. Azure Key Vault supports granular
          access management and secret rotation policies.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/NamedValueSecretsInKV_AuditDeny.json)'
        severity: High
      - name: '[Machines should have secret findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3ac7c827-eea2-4bde-acc7-9568cd320efa)'
        reference: '[Machines should have secret findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3ac7c827-eea2-4bde-acc7-9568cd320efa)'
        description: Audits virtual machines to detect whether they contain secret
          findings from the secret scanning solutions on your virtual machines.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ServerSecretAssessment_Audit.json)'
        severity: Medium
  - name: Privileged Access
    subcategories:
    - name: Separate and limit highly privileged/administrative users
      id: Microsoft cloud security benchmark PA-1
      ownership: Shared
      policies:
      - name: '[A maximum of 3 owners should be designated for your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4f11b553-d42e-4e3a-89be-32ca364cad4c)'
        reference: '[A maximum of 3 owners should be designated for your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4f11b553-d42e-4e3a-89be-32ca364cad4c)'
        description: It is recommended to designate up to 3 subscription owners in
          order to reduce the potential for breach by a compromised owner.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_DesignateLessThanXOwners_Audit.json)'
        severity: Medium
      - name: '[Blocked accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0cfea604-3201-4e14-88fc-fae4c427a6c5)'
        reference: '[Blocked accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0cfea604-3201-4e14-88fc-fae4c427a6c5)'
        description: Deprecated accounts with owner permissions should be removed
          from your subscription.  Deprecated accounts are accounts that have been
          blocked from signing in.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveBlockedAccountsWithOwnerPermissions_Audit.json)'
        severity: Medium
      - name: '[Guest accounts with owner permissions on Azure resources should be
          removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F339353f6-2387-4a45-abe4-7f529d121046)'
        reference: '[Guest accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F339353f6-2387-4a45-abe4-7f529d121046)'
        description: External accounts with owner permissions should be removed from
          your subscription in order to prevent unmonitored access.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveGuestAccountsWithOwnerPermissions_Audit.json)'
        severity: Medium
      - name: '[There should be more than one owner assigned to your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F09024ccc-0c5f-475e-9457-b7c0d9ed487b)'
        reference: '[There should be more than one owner assigned to your subscription](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F09024ccc-0c5f-475e-9457-b7c0d9ed487b)'
        description: It is recommended to designate more than one subscription owner
          in order to have administrator access redundancy.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_DesignateMoreThanOneOwner_Audit.json)'
        severity: Medium
    - name: Avoid standing access for accounts and permissions
      id: Microsoft cloud security benchmark PA-2
      ownership: Shared
      policies:
      - name: '[Management ports of virtual machines should be protected with just-in-time
          network access control](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb0f33259-77d7-4c9e-aac6-3aabcfae693c)'
        reference: '[Management ports of virtual machines should be protected with
          just-in-time network access control](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb0f33259-77d7-4c9e-aac6-3aabcfae693c)'
        description: Possible network Just In Time (JIT) access will be monitored
          by Azure Security Center as recommendations
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_JITNetworkAccess_Audit.json)'
        severity: Medium
    - name: Review and reconcile user access regularly
      id: Microsoft cloud security benchmark PA-4
      ownership: Shared
      policies:
      - name: '[Blocked accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0cfea604-3201-4e14-88fc-fae4c427a6c5)'
        reference: '[Blocked accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0cfea604-3201-4e14-88fc-fae4c427a6c5)'
        description: Deprecated accounts with owner permissions should be removed
          from your subscription.  Deprecated accounts are accounts that have been
          blocked from signing in.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveBlockedAccountsWithOwnerPermissions_Audit.json)'
        severity: Medium
      - name: '[Blocked accounts with read and write permissions on Azure resources
          should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8d7e1fde-fe26-4b5f-8108-f8e432cbc2be)'
        reference: '[Blocked accounts with read and write permissions on Azure resources
          should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8d7e1fde-fe26-4b5f-8108-f8e432cbc2be)'
        description: Deprecated accounts should be removed from your subscriptions.  Deprecated
          accounts are accounts that have been blocked from signing in.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveBlockedAccountsWithReadWritePermissions_Audit.json)'
        severity: Medium
      - name: '[Guest accounts with owner permissions on Azure resources should be
          removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F339353f6-2387-4a45-abe4-7f529d121046)'
        reference: '[Guest accounts with owner permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F339353f6-2387-4a45-abe4-7f529d121046)'
        description: External accounts with owner permissions should be removed from
          your subscription in order to prevent unmonitored access.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveGuestAccountsWithOwnerPermissions_Audit.json)'
        severity: Medium
      - name: '[Guest accounts with read permissions on Azure resources should be
          removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe9ac8f8e-ce22-4355-8f04-99b911d6be52)'
        reference: '[Guest accounts with read permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe9ac8f8e-ce22-4355-8f04-99b911d6be52)'
        description: External accounts with read privileges should be removed from
          your subscription in order to prevent unmonitored access.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveGuestAccountsWithReadPermissions_Audit.json)'
        severity: Medium
      - name: '[Guest accounts with write permissions on Azure resources should be
          removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F94e1c2ac-cbbe-4cac-a2b5-389c812dee87)'
        reference: '[Guest accounts with write permissions on Azure resources should
          be removed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F94e1c2ac-cbbe-4cac-a2b5-389c812dee87)'
        description: External accounts with write privileges should be removed from
          your subscription in order to prevent unmonitored access.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_RemoveGuestAccountsWithWritePermissions_Audit.json)'
        severity: Medium
    - name: Follow just enough administration (least privilege) principle
      id: Microsoft cloud security benchmark PA-7
      ownership: Shared
      policies:
      - name: '[API Management subscriptions should not be scoped to all APIs](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3aa03346-d8c5-4994-a5bc-7652c2a2aef1)'
        reference: '[API Management subscriptions should not be scoped to all APIs](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3aa03346-d8c5-4994-a5bc-7652c2a2aef1)'
        description: API Management subscriptions should be scoped to a product or
          an individual API instead of all APIs, which could result in an excessive
          data exposure.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/AllApiSubscription_AuditDeny.json)'
        severity: High
      - name: '[Audit usage of custom RBAC roles](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa451c1ef-c6ca-483d-87ed-f49761e3ffb5)'
        reference: '[Audit usage of custom RBAC roles](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa451c1ef-c6ca-483d-87ed-f49761e3ffb5)'
        description: Audit built-in roles such as 'Owner, Contributer, Reader' instead
          of custom RBAC roles, which are error prone. Using custom roles is treated
          as an exception and requires a rigorous review and threat modeling
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/General/Subscription_AuditCustomRBACRoles_Audit.json)'
        severity: Medium
      - name: '[Role-Based Access Control (RBAC) should be used on Kubernetes Services](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fac4a19c2-fa67-49b4-8ae5-0b2e78c49457)'
        reference: '[Role-Based Access Control (RBAC) should be used on Kubernetes
          Services](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fac4a19c2-fa67-49b4-8ae5-0b2e78c49457)'
        description: To provide granular filtering on the actions that users can perform,
          use Role-Based Access Control (RBAC) to manage permissions in Kubernetes
          Service Clusters and configure relevant authorization policies.
        effects:
        - Audit
        - Disabled
        version: '[1.0.4](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableRBAC_KubernetesService_Audit.json)'
        severity: Medium
  - name: Data Protection
    subcategories:
    - name: Discover, classify, and label sensitive data
      id: Microsoft cloud security benchmark DP-1
      ownership: Shared
      policies:
      - name: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        reference: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        description: Microsoft Defender for APIs brings new discovery, protection,
          detection, & response coverage to monitor for common API based attacks &
          security misconfigurations.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDefenderForAPIS_Audit.json)'
        severity: Medium
    - name: Monitor anomalies and threats targeting sensitive data
      id: Microsoft cloud security benchmark DP-2
      ownership: Shared
      policies:
      - name: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        reference: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServers_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for open-source relational databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        reference: '[Azure Defender for open-source relational databases should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        description: 'Azure Defender for open-source relational databases detects
          anomalous activities indicating unusual and potentially harmful attempts
          to access or exploit databases. Learn more about the capabilities of Azure
          Defender for open-source relational databases at [https://aka.ms/AzDforOpenSourceDBsDocu](https://aka.ms/AzDforOpenSourceDBsDocu).
          Important: Enabling this plan will result in charges for protecting your
          open-source relational databases. Learn about the pricing on Security Center''s
          pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnOpenSourceRelationalDatabases_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        reference: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServerVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected SQL Managed
          Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected SQL
          Managed Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        description: Audit each SQL Managed Instance without advanced data security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        reference: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        description: Microsoft Defender for APIs brings new discovery, protection,
          detection, & response coverage to monitor for common API based attacks &
          security misconfigurations.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDefenderForAPIS_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        reference: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        description: 'Microsoft Defender for Storage detects potential threats to
          your storage accounts. It helps prevent the three major impacts on your
          data and workload: malicious file uploads, sensitive data exfiltration,
          and data corruption. The new Defender for Storage plan includes Malware
          Scanning and Sensitive Data Threat Detection. This plan also provides a
          predictable pricing structure (per storage account) for control over coverage
          and costs.'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_Microsoft_Defender_For_Storage_Full_Audit.json)'
        severity: Medium
    - name: Encrypt sensitive data in transit
      id: Microsoft cloud security benchmark DP-3
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Host and VM networking should be protected on Azure Stack
          HCI systems](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F36f0d6bc-a253-4df8-b25b-c3a5023ff443)'
        reference: '[\[Preview\]: Host and VM networking should be protected on Azure
          Stack HCI systems](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F36f0d6bc-a253-4df8-b25b-c3a5023ff443)'
        description: Protect data on the Azure Stack HCI hosts network and on virtual
          machine network connections.
        effects:
        - Audit
        - Disabled
        - AuditIfNotExists
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Stack%20HCI/DataInTransitProtectedAtCluster_Audit.json)'
        severity: Medium
      - name: '[API Management APIs should use only encrypted protocols](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fee7495e7-3ba7-40b6-bfee-c29e22cc75d4)'
        reference: '[API Management APIs should use only encrypted protocols](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fee7495e7-3ba7-40b6-bfee-c29e22cc75d4)'
        description: To ensure security of data in transit, APIs should be available
          only through encrypted protocols, like HTTPS or WSS. Avoid using unsecured
          protocols, such as HTTP or WS.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[2.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/HTTPEnabled_AuditDeny.json)'
        severity: High
      - name: '[App Service apps should only be accessible over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa4af4a39-4135-47fb-b175-47fbdf85311d)'
        reference: '[App Service apps should only be accessible over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa4af4a39-4135-47fb-b175-47fbdf85311d)'
        description: Use of HTTPS ensures server/service authentication and protects
          data in transit from network layer eavesdropping attacks.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[4.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/Webapp_AuditHTTP_Audit.json)'
        severity: High
      - name: '[App Service apps should require FTPS only](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b)'
        reference: '[App Service apps should require FTPS only](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b)'
        description: Enable FTPS enforcement for enhanced security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/AuditFTPS_WebApp_Audit.json)'
        severity: Medium
      - name: '[App Service apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b)'
        reference: '[App Service apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b)'
        description: Periodically, newer versions are released for TLS either due
          to security flaws, include additional functionality, and enhance speed.
          Upgrade to the latest TLS version for App Service apps to take advantage
          of security fixes, if any, and/or new functionalities of the latest version.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RequireLatestTls_WebApp_Audit.json)'
        severity: Medium
      - name: '[Azure SQL Database should be running TLS version 1.2 or newer](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F32e6bbec-16b6-44c2-be37-c5b672d103cf)'
        reference: '[Azure SQL Database should be running TLS version 1.2 or newer](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F32e6bbec-16b6-44c2-be37-c5b672d103cf)'
        description: Setting TLS version to 1.2 or newer improves security by ensuring
          your Azure SQL Database can only be accessed from clients using TLS 1.2
          or newer. Using versions of TLS less than 1.2 is not recommended since they
          have well documented security vulnerabilities.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_MiniumTLSVersion_Audit.json)'
        severity: High
      - name: '[Enforce SSL connection should be enabled for MySQL database servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe802a67a-daf5-4436-9ea6-f6d821dd0c5d)'
        reference: '[Enforce SSL connection should be enabled for MySQL database servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe802a67a-daf5-4436-9ea6-f6d821dd0c5d)'
        description: Azure Database for MySQL supports connecting your Azure Database
          for MySQL server to client applications using Secure Sockets Layer (SSL).
          Enforcing SSL connections between your database server and your client applications
          helps protect against 'man in the middle' attacks by encrypting the data
          stream between the server and your application. This configuration enforces
          that SSL is always enabled for accessing your database server.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_EnableSSL_Audit.json)'
        severity: Medium
      - name: '[Enforce SSL connection should be enabled for PostgreSQL database servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd158790f-bfb0-486c-8631-2dc6b4e8e6af)'
        reference: '[Enforce SSL connection should be enabled for PostgreSQL database
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd158790f-bfb0-486c-8631-2dc6b4e8e6af)'
        description: Azure Database for PostgreSQL supports connecting your Azure
          Database for PostgreSQL server to client applications using Secure Sockets
          Layer (SSL). Enforcing SSL connections between your database server and
          your client applications helps protect against 'man in the middle' attacks
          by encrypting the data stream between the server and your application. This
          configuration enforces that SSL is always enabled for accessing your database
          server.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_EnableSSL_Audit.json)'
        severity: Medium
      - name: '[Function apps should only be accessible over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab)'
        reference: '[Function apps should only be accessible over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab)'
        description: Use of HTTPS ensures server/service authentication and protects
          data in transit from network layer eavesdropping attacks.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/FunctionApp_AuditHTTP_Audit.json)'
        severity: High
      - name: '[Function apps should require FTPS only](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F399b2637-a50f-4f95-96f8-3a145476eb15)'
        reference: '[Function apps should require FTPS only](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F399b2637-a50f-4f95-96f8-3a145476eb15)'
        description: Enable FTPS enforcement for enhanced security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/AuditFTPS_FunctionApp_Audit.json)'
        severity: Medium
      - name: '[Function apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9d614c5-c173-4d56-95a7-b4437057d193)'
        reference: '[Function apps should use the latest TLS version](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9d614c5-c173-4d56-95a7-b4437057d193)'
        description: Periodically, newer versions are released for TLS either due
          to security flaws, include additional functionality, and enhance speed.
          Upgrade to the latest TLS version for Function apps to take advantage of
          security fixes, if any, and/or new functionalities of the latest version.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RequireLatestTls_FunctionApp_Audit.json)'
        severity: Medium
      - name: '[Kubernetes clusters should be accessible only over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d)'
        reference: '[Kubernetes clusters should be accessible only over HTTPS](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d)'
        description: Use of HTTPS ensures authentication and protects data in transit
          from network layer eavesdropping attacks. This capability is currently generally
          available for Kubernetes Service (AKS), and in preview for Azure Arc enabled
          Kubernetes. For more info, visit [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc)
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[8.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/IngressHttpsOnly.json)'
        severity: High
      - name: '[Only secure connections to your Azure Cache for Redis should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F22bee202-a82f-4305-9a2a-6d7f44d4dedb)'
        reference: '[Only secure connections to your Azure Cache for Redis should
          be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F22bee202-a82f-4305-9a2a-6d7f44d4dedb)'
        description: Audit enabling of only connections via SSL to Azure Cache for
          Redis. Use of secure connections ensures authentication between the server
          and the service and protects data in transit from network layer attacks
          such as man-in-the-middle, eavesdropping, and session-hijacking
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cache/RedisCache_AuditSSLPort_Audit.json)'
        severity: High
      - name: '[Secure transfer to storage accounts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F404c3081-a854-4457-ae30-26a93ef643f9)'
        reference: '[Secure transfer to storage accounts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F404c3081-a854-4457-ae30-26a93ef643f9)'
        description: Audit requirement of Secure transfer in your storage account.
          Secure transfer is an option that forces your storage account to accept
          requests only from secure connections (HTTPS). Use of HTTPS ensures authentication
          between the server and the service and protects data in transit from network
          layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/Storage_AuditForHTTPSEnabled_Audit.json)'
        severity: High
      - name: '[Windows machines should be configured to use secure communication
          protocols](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5752e6d6-1206-46d8-8ab1-ecc2f71a8112)'
        reference: '[Windows machines should be configured to use secure communication
          protocols](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5752e6d6-1206-46d8-8ab1-ecc2f71a8112)'
        description: To protect the privacy of information communicated over the Internet,
          your machines should use the latest version of the industry-standard cryptographic
          protocol, Transport Layer Security (TLS). TLS secures communications over
          a network by encrypting a connection between machines.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[4.1.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/SecureWebProtocol_AINE.json)'
        severity: Medium
    - name: Enable data at rest encryption by default
      id: Microsoft cloud security benchmark DP-4
      ownership: Shared
      policies:
      - name: '[A Microsoft Entra administrator should be provisioned for MySQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F146412e9-005c-472b-9e48-c87b72ac229e)'
        reference: '[A Microsoft Entra administrator should be provisioned for MySQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F146412e9-005c-472b-9e48-c87b72ac229e)'
        description: Audit provisioning of a Microsoft Entra administrator for your
          MySQL server to enable Microsoft Entra authentication. Microsoft Entra authentication
          enables simplified permission management and centralized identity management
          of database users and other Microsoft services
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.1.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_AuditServerADAdmins_Audit.json)'
        severity: Medium
      - name: '[Automation account variables should be encrypted](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3657f5a0-770e-44a3-b44e-9431ba1e9735)'
        reference: '[Automation account variables should be encrypted](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3657f5a0-770e-44a3-b44e-9431ba1e9735)'
        description: It is important to enable encryption of Automation account variable
          assets when storing sensitive data
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Automation/AuditUnencryptedVars_Audit.json)'
        severity: High
      - name: '[Azure MySQL flexible server should have Microsoft Entra Only Authentication
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F40e85574-ef33-47e8-a854-7a65c7500560)'
        reference: '[Azure MySQL flexible server should have Microsoft Entra Only
          Authentication enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F40e85574-ef33-47e8-a854-7a65c7500560)'
        description: Disabling local authentication methods and allowing only Microsoft
          Entra Authentication improves security by ensuring that Azure MySQL flexible
          server can exclusively be accessed by Microsoft Entra identities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_FlexibleServers_ADOnlyEnabled_Audit.json)'
        severity: Medium
      - name: '[Linux virtual machines should enable Azure Disk Encryption or EncryptionAtHost.](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fca88aadc-6e2b-416c-9de2-5a0f01d1693f)'
        reference: '[Linux virtual machines should enable Azure Disk Encryption or
          EncryptionAtHost.](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fca88aadc-6e2b-416c-9de2-5a0f01d1693f)'
        description: Although a virtual machine's OS and data disks are encrypted-at-rest
          by default using platform managed keys; resource disks (temp disks), data
          caches, and data flowing between Compute and Storage resources are not encrypted.
          Use Azure Disk Encryption or EncryptionAtHost to remediate. Visit [https://aka.ms/diskencryptioncomparison](https://aka.ms/diskencryptioncomparison)
          to compare encryption offerings. This policy requires two prerequisites
          to be deployed to the policy assignment scope. For details, visit [https://aka.ms/gcpol](https://aka.ms/gcpol).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/LinuxVMEncryption_AINE.json)'
        severity: Medium
      - name: '[Service Fabric clusters should have the ClusterProtectionLevel property
          set to EncryptAndSign](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F617c02be-7f02-4efd-8836-3180d47b6c68)'
        reference: '[Service Fabric clusters should have the ClusterProtectionLevel
          property set to EncryptAndSign](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F617c02be-7f02-4efd-8836-3180d47b6c68)'
        description: Service Fabric provides three levels of protection (None, Sign
          and EncryptAndSign) for node-to-node communication using a primary cluster
          certificate. Set the protection level to ensure that all node-to-node messages
          are encrypted and digitally signed
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Service%20Fabric/AuditClusterProtectionLevel_Audit.json)'
        severity: High
      - name: '[Transparent Data Encryption on SQL databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17k78e20-9358-41c9-923c-fb736d382a12)'
        reference: '[Transparent Data Encryption on SQL databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17k78e20-9358-41c9-923c-fb736d382a12)'
        description: Transparent data encryption should be enabled to protect data-at-rest
          and meet compliance requirements
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlDBEncryption_Audit.json)'
        severity: Medium
      - name: '[Virtual machines and virtual machine scale sets should have encryption
          at host enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc4d8e41-e223-45ea-9bf5-eada37891d87)'
        reference: '[Virtual machines and virtual machine scale sets should have encryption
          at host enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc4d8e41-e223-45ea-9bf5-eada37891d87)'
        description: Use encryption at host to get end-to-end encryption for your
          virtual machine and virtual machine scale set data. Encryption at host enables
          encryption at rest for your temporary disk and OS/data disk caches. Temporary
          and ephemeral OS disks are encrypted with platform-managed keys when encryption
          at host is enabled. OS/data disk caches are encrypted at rest with either
          customer-managed or platform-managed key, depending on the encryption type
          selected on the disk. Learn more at [https://aka.ms/vm-hbe](https://aka.ms/vm-hbe).
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Compute/HostBasedEncryptionRequired_Deny.json)'
        severity: High
      - name: '[Windows virtual machines should enable Azure Disk Encryption or EncryptionAtHost.](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3dc5edcd-002d-444c-b216-e123bbfa37c0)'
        reference: '[Windows virtual machines should enable Azure Disk Encryption
          or EncryptionAtHost.](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3dc5edcd-002d-444c-b216-e123bbfa37c0)'
        description: Although a virtual machine's OS and data disks are encrypted-at-rest
          by default using platform managed keys; resource disks (temp disks), data
          caches, and data flowing between Compute and Storage resources are not encrypted.
          Use Azure Disk Encryption or EncryptionAtHost to remediate. Visit [https://aka.ms/diskencryptioncomparison](https://aka.ms/diskencryptioncomparison)
          to compare encryption offerings. This policy requires two prerequisites
          to be deployed to the policy assignment scope. For details, visit [https://aka.ms/gcpol](https://aka.ms/gcpol).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.1.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/WindowsVMEncryption_AINE.json)'
        severity: Medium
    - name: Use customer-managed key option in data at rest encryption when required
      id: Microsoft cloud security benchmark DP-5
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Azure Stack HCI systems should have encrypted volumes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fee8ca833-1583-4d24-837e-96c2af9488a4)'
        reference: '[\[Preview\]: Azure Stack HCI systems should have encrypted volumes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fee8ca833-1583-4d24-837e-96c2af9488a4)'
        description: Use BitLocker to encrypt the OS and data volumes on Azure Stack
          HCI systems.
        effects:
        - Audit
        - Disabled
        - AuditIfNotExists
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Stack%20HCI/DataAtRestEncryptedAtCluster_Audit.json)'
        severity: Medium
      - name: '[Azure AI Services resources should encrypt data at rest with a customer-managed
          key (CMK)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F67121cc7-ff39-4ab8-b7e3-95b84dab487d)'
        reference: '[Azure AI Services resources should encrypt data at rest with
          a customer-managed key (CMK)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F67121cc7-ff39-4ab8-b7e3-95b84dab487d)'
        description: Using customer-managed keys to encrypt data at rest provides
          more control over the key lifecycle, including rotation and management.
          This is particularly relevant for organizations with related compliance
          requirements. This is not assessed by default and should only be applied
          when required by compliance or restrictive policy requirements. If not enabled,
          the data will be encrypted using platform-managed keys. To implement this,
          update the 'Effect' parameter in the Security Policy for the applicable
          scope.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cognitive%20Services/CustomerManagedKey_Audit.json)'
        severity: High
      - name: '[Azure Cosmos DB accounts should use customer-managed keys to encrypt
          data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f905d99-2ab7-462c-a6b0-f709acca6c8f)'
        reference: '[Azure Cosmos DB accounts should use customer-managed keys to
          encrypt data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f905d99-2ab7-462c-a6b0-f709acca6c8f)'
        description: Use customer-managed keys to manage the encryption at rest of
          your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed
          keys, but customer-managed keys are commonly required to meet regulatory
          compliance standards. Customer-managed keys enable the data to be encrypted
          with an Azure Key Vault key created and owned by you. You have full control
          and responsibility for the key lifecycle, including rotation and management.
          Learn more at [https://aka.ms/cosmosdb-cmk](https://aka.ms/cosmosdb-cmk).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Cosmos%20DB/Cosmos_CMK_Deny.json)'
        severity: High
      - name: '[Azure Machine Learning workspaces should be encrypted with a customer-managed
          key](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fba769a63-b8cc-4b2d-abf6-ac33c7204be8)'
        reference: '[Azure Machine Learning workspaces should be encrypted with a
          customer-managed key](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fba769a63-b8cc-4b2d-abf6-ac33c7204be8)'
        description: Manage encryption at rest of Azure Machine Learning workspace
          data with customer-managed keys. By default, customer data is encrypted
          with service-managed keys, but customer-managed keys are commonly required
          to meet regulatory compliance standards. Customer-managed keys enable the
          data to be encrypted with an Azure Key Vault key created and owned by you.
          You have full control and responsibility for the key lifecycle, including
          rotation and management. Learn more at [https://aka.ms/azureml-workspaces-cmk](https://aka.ms/azureml-workspaces-cmk).
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/Workspace_CMKEnabled_Audit.json)'
        severity: High
      - name: '[Container registries should be encrypted with a customer-managed key](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580)'
        reference: '[Container registries should be encrypted with a customer-managed
          key](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580)'
        description: Use customer-managed keys to manage the encryption at rest of
          the contents of your registries. By default, the data is encrypted at rest
          with service-managed keys, but customer-managed keys are commonly required
          to meet regulatory compliance standards. Customer-managed keys enable the
          data to be encrypted with an Azure Key Vault key created and owned by you.
          You have full control and responsibility for the key lifecycle, including
          rotation and management. Learn more at [https://aka.ms/acr/CMK](https://aka.ms/acr/CMK).
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.1.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Container%20Registry/ACR_CMKEncryptionEnabled_Audit.json)'
        severity: High
      - name: '[MySQL servers should use customer-managed keys to encrypt data at
          rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F83cef61d-dbd1-4b20-a4fc-5fbc7da10833)'
        reference: '[MySQL servers should use customer-managed keys to encrypt data
          at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F83cef61d-dbd1-4b20-a4fc-5fbc7da10833)'
        description: Use customer-managed keys to manage the encryption at rest of
          your MySQL servers. By default, the data is encrypted at rest with service-managed
          keys, but customer-managed keys are commonly required to meet regulatory
          compliance standards. Customer-managed keys enable the data to be encrypted
          with an Azure Key Vault key created and owned by you. You have full control
          and responsibility for the key lifecycle, including rotation and management.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.4](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/MySQL_EnableByok_Audit.json)'
        severity: Medium
      - name: '[PostgreSQL servers should use customer-managed keys to encrypt data
          at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F18adea5e-f416-4d0f-8aa8-d24321e3e274)'
        reference: '[PostgreSQL servers should use customer-managed keys to encrypt
          data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F18adea5e-f416-4d0f-8aa8-d24321e3e274)'
        description: Use customer-managed keys to manage the encryption at rest of
          your PostgreSQL servers. By default, the data is encrypted at rest with
          service-managed keys, but customer-managed keys are commonly required to
          meet regulatory compliance standards. Customer-managed keys enable the data
          to be encrypted with an Azure Key Vault key created and owned by you. You
          have full control and responsibility for the key lifecycle, including rotation
          and management.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.4](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/PostgreSQL_EnableByok_Audit.json)'
        severity: Medium
      - name: '[SQL managed instances should use customer-managed keys to encrypt
          data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fac01ad65-10e5-46df-bdd9-6b0cad13e1d2)'
        reference: '[SQL managed instances should use customer-managed keys to encrypt
          data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fac01ad65-10e5-46df-bdd9-6b0cad13e1d2)'
        description: Implementing Transparent Data Encryption (TDE) with your own
          key provides you with increased transparency and control over the TDE Protector,
          increased security with an HSM-backed external service, and promotion of
          separation of duties. This recommendation applies to organizations with
          a related compliance requirement.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_EnsureServerTDEisEncrypted_Deny.json)'
        severity: High
      - name: '[SQL servers should use customer-managed keys to encrypt data at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a370ff3-6cab-4e85-8995-295fd854c5b8)'
        reference: '[SQL servers should use customer-managed keys to encrypt data
          at rest](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a370ff3-6cab-4e85-8995-295fd854c5b8)'
        description: Implementing Transparent Data Encryption (TDE) with your own
          key provides increased transparency and control over the TDE Protector,
          increased security with an HSM-backed external service, and promotion of
          separation of duties. This recommendation applies to organizations with
          a related compliance requirement.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_EnsureServerTDEisEncryptedWithYourOwnKey_Deny.json)'
        severity: High
      - name: '[Storage accounts should use customer-managed key for encryption](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6fac406b-40ca-413b-bf8e-0bf964659c25)'
        reference: '[Storage accounts should use customer-managed key for encryption](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6fac406b-40ca-413b-bf8e-0bf964659c25)'
        description: Secure your blob and file storage account with greater flexibility
          using customer-managed keys. When you specify a customer-managed key, that
          key is used to protect and control access to the key that encrypts your
          data. Using customer-managed keys provides additional capabilities to control
          rotation of the key encryption key or cryptographically erase data.
        effects:
        - Audit
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/StorageAccountCustomerManagedKeyEnabled_Audit.json)'
        severity: Medium
    - name: Use a secure key management process
      id: Microsoft cloud security benchmark DP-6
      ownership: Shared
      policies:
      - name: '[API Management secret named values should be stored in Azure Key Vault](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff1cc7827-022c-473e-836e-5a51cae0b249)'
        reference: '[API Management secret named values should be stored in Azure
          Key Vault](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff1cc7827-022c-473e-836e-5a51cae0b249)'
        description: Named values are a collection of name and value pairs in each
          API Management service. Secret values can be stored either as encrypted
          text in API Management (custom secrets) or by referencing secrets in Azure
          Key Vault. To improve security of API Management and secrets, reference
          secret named values from Azure Key Vault. Azure Key Vault supports granular
          access management and secret rotation policies.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/NamedValueSecretsInKV_AuditDeny.json)'
        severity: High
      - name: '[Key Vault keys should have an expiration date](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0)'
        reference: '[Key Vault keys should have an expiration date](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0)'
        description: Cryptographic keys should have a defined expiration date and
          not be permanent. Keys that are valid forever provide a potential attacker
          with more time to compromise the key. It is a recommended security practice
          to set expiration dates on cryptographic keys.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Keys_ExpirationSet.json)'
        severity: High
      - name: '[Key Vault secrets should have an expiration date](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F98728c90-32c7-4049-8429-847dc0f4fe37)'
        reference: '[Key Vault secrets should have an expiration date](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F98728c90-32c7-4049-8429-847dc0f4fe37)'
        description: Secrets should have a defined expiration date and not be permanent.
          Secrets that are valid forever provide a potential attacker with more time
          to compromise them. It is a recommended security practice to set expiration
          dates on secrets.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Secrets_ExpirationSet.json)'
        severity: High
    - name: Use a secure certificate management process
      id: Microsoft cloud security benchmark DP-7
      ownership: Shared
      policies:
      - name: '[Certificates should have the specified maximum validity period](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a075868-4c26-42ef-914c-5bc007359560)'
        reference: '[Certificates should have the specified maximum validity period](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a075868-4c26-42ef-914c-5bc007359560)'
        description: Manage your organizational compliance requirements by specifying
          the maximum amount of time that a certificate can be valid within your key
          vault.
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[2.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Certificates_ValidityPeriod.json)'
        severity: High
    - name: Ensure security of key and certificate repository
      id: Microsoft cloud security benchmark DP-8
      ownership: Shared
      policies:
      - name: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        reference: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        description: Azure Defender for Key Vault provides an additional layer of
          protection and security intelligence by detecting unusual and potentially
          harmful attempts to access or exploit key vault accounts.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnKeyVaults_Audit.json)'
        severity: Medium
      - name: '[Azure Key Vault should have firewall enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F55615ac9-af46-4a59-874e-391cc3dfb490)'
        reference: '[Azure Key Vault should have firewall enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F55615ac9-af46-4a59-874e-391cc3dfb490)'
        description: 'Enable the key vault firewall so that the key vault is not accessible
          by default to any public IPs. Optionally, you can configure specific IP
          ranges to limit access to those networks. Learn more at: [https://docs.microsoft.com/azure/key-vault/general/network-security](/azure/key-vault/general/network-security)'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[3.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/FirewallEnabled_Audit.json)'
        severity: High
      - name: '[Azure Key Vaults should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6abeaec-4d90-4a02-805f-6b26c4d3fbe9)'
        reference: '[Azure Key Vaults should use private link](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6abeaec-4d90-4a02-805f-6b26c4d3fbe9)'
        description: 'Azure Private Link lets you connect your virtual networks to
          Azure services without a public IP address at the source or destination.
          The Private Link platform handles the connectivity between the consumer
          and services over the Azure backbone network. By mapping private endpoints
          to key vault, you can reduce data leakage risks. Learn more about private
          links at: [https://aka.ms/akvprivatelink](https://aka.ms/akvprivatelink).'
        effects:
        - '[parameters(''audit_effect'')]'
        version: '[1.2.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Should_Use_PrivateEndpoint_Audit.json)'
        severity: Medium
      - name: '[Key vaults should have deletion protection enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0b60c0b2-2dc2-4e1c-b5c9-abbed971de53)'
        reference: '[Key vaults should have deletion protection enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0b60c0b2-2dc2-4e1c-b5c9-abbed971de53)'
        description: Malicious deletion of a key vault can lead to permanent data
          loss. You can prevent permanent data loss by enabling purge protection and
          soft delete. Purge protection protects you from insider attacks by enforcing
          a mandatory retention period for soft deleted key vaults. No one inside
          your organization or Microsoft will be able to purge your key vaults during
          the soft delete retention period. Keep in mind that key vaults created after
          September 1st 2019 have soft-delete enabled by default.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/Recoverable_Audit.json)'
        severity: High
      - name: '[Key vaults should have soft delete enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d)'
        reference: '[Key vaults should have soft delete enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d)'
        description: Deleting a key vault without soft delete enabled permanently
          deletes all secrets, keys, and certificates stored in the key vault. Accidental
          deletion of a key vault can lead to permanent data loss. Soft delete allows
          you to recover an accidentally deleted key vault for a configurable retention
          period.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/SoftDeleteMustBeEnabled_Audit.json)'
        severity: High
      - name: '[Resource logs in Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcf820ca0-f99e-4f3e-84fb-66e913812d21)'
        reference: '[Resource logs in Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcf820ca0-f99e-4f3e-84fb-66e913812d21)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/AuditDiagnosticLog_Audit.json)'
        severity: Medium
  - name: Asset Management
    subcategories:
    - name: Use only approved services
      id: Microsoft cloud security benchmark AM-2
      ownership: Shared
      policies:
      - name: '[Azure API Management platform version should be stv2](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1dc2fc00-2245-4143-99f4-874c937f13ef)'
        reference: '[Azure API Management platform version should be stv2](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1dc2fc00-2245-4143-99f4-874c937f13ef)'
        description: Azure API Management stv1 compute platform version will be retired
          effective 31 August 2024, and these instances should be migrated to stv2
          compute platform for continued support. Learn more at [https://learn.microsoft.com/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024](/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024)
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/PlatformVersion_AuditDeny.json)'
        severity: High
      - name: '[Storage accounts should be migrated to new Azure Resource Manager
          resources](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F37e0d2fe-28a5-43d6-a273-67d37d1f5606)'
        reference: '[Storage accounts should be migrated to new Azure Resource Manager
          resources](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F37e0d2fe-28a5-43d6-a273-67d37d1f5606)'
        description: 'Use new Azure Resource Manager for your storage accounts to
          provide security enhancements such as: stronger access control (RBAC), better
          auditing, Azure Resource Manager based deployment and governance, access
          to managed identities, access to key vault for secrets, Azure AD-based authentication
          and support for tags and resource groups for easier security management'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Storage/Classic_AuditForClassicStorages_Audit.json)'
        severity: High
      - name: '[Virtual machines should be migrated to new Azure Resource Manager
          resources](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1d84d5fb-01f6-4d12-ba4f-4a26081d403d)'
        reference: '[Virtual machines should be migrated to new Azure Resource Manager
          resources](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1d84d5fb-01f6-4d12-ba4f-4a26081d403d)'
        description: 'Use new Azure Resource Manager for your virtual machines to
          provide security enhancements such as: stronger access control (RBAC), better
          auditing, Azure Resource Manager based deployment and governance, access
          to managed identities, access to key vault for secrets, Azure AD-based authentication
          and support for tags and resource groups for easier security management'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Compute/ClassicCompute_Audit.json)'
        severity: High
    - name: Ensure security of asset lifecycle management
      id: Microsoft cloud security benchmark AM-3
      ownership: Shared
      policies:
      - name: '[API endpoints that are unused should be disabled and removed from
          the Azure API Management service](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc8acafaf-3d23-44d1-9624-978ef0f8652c)'
        reference: '[API endpoints that are unused should be disabled and removed
          from the Azure API Management service](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc8acafaf-3d23-44d1-9624-978ef0f8652c)'
        description: As a security best practice, API endpoints that haven't received
          traffic for 30 days are considered unused and should be removed from the
          Azure API Management service. Keeping unused API endpoints may pose a security
          risk to your organization. These may be APIs that should have been deprecated
          from the Azure API Management service but may have been accidentally left
          active. Such APIs typically do not receive the most up to date security
          coverage.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_APIMUnusedApiEndpointsShouldbeRemoved_AINE.json)'
        severity: Medium
  - name: Logging and Threat Detection
    subcategories:
    - name: Enable threat detection capabilities
      id: Microsoft cloud security benchmark LT-1
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Azure Arc enabled Kubernetes clusters should have Microsoft
          Defender for Cloud extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8dfab9c4-fe7b-49ad-85e4-1e9be085358f)'
        reference: '[\[Preview\]: Azure Arc enabled Kubernetes clusters should have
          Microsoft Defender for Cloud extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8dfab9c4-fe7b-49ad-85e4-1e9be085358f)'
        description: Microsoft Defender for Cloud extension for Azure Arc provides
          threat protection for your Arc enabled Kubernetes clusters. The extension
          collects data from all nodes in the cluster and sends it to the Azure Defender
          for Kubernetes backend in the cloud for further analysis. Learn more in
          [https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?pivots=defender-for-container-arc](/azure/defender-for-cloud/defender-for-containers-enable).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[6.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ASC_Azure_Defender_Arc_Extension_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        reference: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        description: Azure Defender for App Service leverages the scale of the cloud,
          and the visibility that Azure has as a cloud provider, to monitor for common
          web app attacks.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnAppServices_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        reference: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServers_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        reference: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        description: Azure Defender for Key Vault provides an additional layer of
          protection and security intelligence by detecting unusual and potentially
          harmful attempts to access or exploit key vault accounts.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnKeyVaults_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for open-source relational databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        reference: '[Azure Defender for open-source relational databases should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        description: 'Azure Defender for open-source relational databases detects
          anomalous activities indicating unusual and potentially harmful attempts
          to access or exploit databases. Learn more about the capabilities of Azure
          Defender for open-source relational databases at [https://aka.ms/AzDforOpenSourceDBsDocu](https://aka.ms/AzDforOpenSourceDBsDocu).
          Important: Enabling this plan will result in charges for protecting your
          open-source relational databases. Learn about the pricing on Security Center''s
          pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnOpenSourceRelationalDatabases_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        reference: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        description: 'Azure Defender for Resource Manager automatically monitors the
          resource management operations in your organization. Azure Defender detects
          threats and alerts you about suspicious activity. Learn more about the capabilities
          of Azure Defender for Resource Manager at [https://aka.ms/defender-for-resource-manager](https://aka.ms/defender-for-resource-manager)
          . Enabling this Azure Defender plan results in charges. Learn about the
          pricing details per region on Security Center''s pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)
          .'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnResourceManager_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        reference: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        description: Azure Defender for servers provides real-time threat protection
          for server workloads and generates hardening recommendations as well as
          alerts about suspicious activities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnVM_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        reference: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServerVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected Azure SQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected Azure
          SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        description: Audit SQL servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected MySQL flexible
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        reference: '[Azure Defender for SQL should be enabled for unprotected MySQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        description: Audit MySQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MySQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        reference: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        description: Audit PostgreSQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/PostgreSQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected SQL Managed
          Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected SQL
          Managed Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        description: Audit each SQL Managed Instance without advanced data security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Kubernetes Service clusters should have Defender profile enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa1840de2-8088-4ea8-b153-b4c723e9cb01)'
        reference: '[Azure Kubernetes Service clusters should have Defender profile
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa1840de2-8088-4ea8-b153-b4c723e9cb01)'
        description: Microsoft Defender for Containers provides cloud-native Kubernetes
          security capabilities including environment hardening, workload protection,
          and run-time protection. When you enable the SecurityProfile.AzureDefender
          on your Azure Kubernetes Service cluster, an agent is deployed to your cluster
          to collect security event data. Learn more about Microsoft Defender for
          Containers in [https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks](/azure/defender-for-cloud/defender-for-containers-introduction)
        effects:
        - Audit
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ASC_Azure_Defender_AKS_SecurityProfile_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        reference: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        description: Defender Cloud Security Posture Management (CSPM) provides enhanced
          posture capabilities and a new intelligent cloud security graph to help
          identify, prioritize, and reduce risk. Defender CSPM is available in addition
          to the free foundational security posture capabilities turned on by default
          in Defender for Cloud.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Azure_Defender_CSPM_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        reference: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        description: Microsoft Defender for APIs brings new discovery, protection,
          detection, & response coverage to monitor for common API based attacks &
          security misconfigurations.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDefenderForAPIS_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        reference: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        description: Microsoft Defender for Containers provides hardening, vulnerability
          assessment and run-time protections for your Azure, hybrid, and multi-cloud
          Kubernetes environments.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnContainers_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL should be enabled for unprotected Synapse
          workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        reference: '[Microsoft Defender for SQL should be enabled for unprotected
          Synapse workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        description: Enable Defender for SQL to protect your Synapse workspaces. Defender
          for SQL monitors your Synapse SQL to detect anomalous activities indicating
          unusual and potentially harmful attempts to access or exploit databases.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/TdOnSynapseWorkspaces_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        reference: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        description: Microsoft Defender for SQL provides functionality for surfacing
          and mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, discovering and classifying
          sensitive data. Once enabled, the protection status indicates that the resource
          is actively monitored. Even when Defender is enabled, multiple configuration
          settings should be validated on the agent, machine, workspace and SQL server
          to ensure active protection.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ProtectDefenderForSQLOnArc_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        reference: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        description: 'Microsoft Defender for Storage detects potential threats to
          your storage accounts. It helps prevent the three major impacts on your
          data and workload: malicious file uploads, sensitive data exfiltration,
          and data corruption. The new Defender for Storage plan includes Malware
          Scanning and Sensitive Data Threat Detection. This plan also provides a
          predictable pricing structure (per storage account) for control over coverage
          and costs.'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_Microsoft_Defender_For_Storage_Full_Audit.json)'
        severity: Medium
      - name: '[SQL server-targeted autoprovisioning should be enabled for SQL servers
          on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        reference: '[SQL server-targeted autoprovisioning should be enabled for SQL
          servers on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        description: 'To ensure your SQL VMs and Arc-enabled SQL Servers are protected,
          ensure the SQL-targeted Azure Monitoring Agent is configured to automatically
          deploy. This is also necessary if you''ve previously configured autoprovisioning
          of the Microsoft Monitoring Agent, as that component is being deprecated.
          Learn more: [https://aka.ms/SQLAMAMigration](https://aka.ms/SQLAMAMigration)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_DFSQL_AMA_Migration_Audit.json)'
        severity: Medium
      - name: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        reference: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        description: Windows Defender Exploit Guard uses the Azure Policy Guest Configuration
          agent. Exploit Guard has four components that are designed to lock down
          devices against a wide variety of attack vectors and block behaviors commonly
          used in malware attacks while enabling enterprises to balance their security
          risk and productivity requirements (Windows only).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/WindowsDefenderExploitGuard_AINE.json)'
        severity: Medium
    - name: Enable threat detection for identity and access management
      id: Microsoft cloud security benchmark LT-2
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Azure Arc enabled Kubernetes clusters should have Microsoft
          Defender for Cloud extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8dfab9c4-fe7b-49ad-85e4-1e9be085358f)'
        reference: '[\[Preview\]: Azure Arc enabled Kubernetes clusters should have
          Microsoft Defender for Cloud extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F8dfab9c4-fe7b-49ad-85e4-1e9be085358f)'
        description: Microsoft Defender for Cloud extension for Azure Arc provides
          threat protection for your Arc enabled Kubernetes clusters. The extension
          collects data from all nodes in the cluster and sends it to the Azure Defender
          for Kubernetes backend in the cloud for further analysis. Learn more in
          [https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable?pivots=defender-for-container-arc](/azure/defender-for-cloud/defender-for-containers-enable).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[6.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ASC_Azure_Defender_Arc_Extension_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        reference: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        description: Azure Defender for App Service leverages the scale of the cloud,
          and the visibility that Azure has as a cloud provider, to monitor for common
          web app attacks.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnAppServices_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        reference: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServers_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        reference: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        description: Azure Defender for Key Vault provides an additional layer of
          protection and security intelligence by detecting unusual and potentially
          harmful attempts to access or exploit key vault accounts.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnKeyVaults_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for open-source relational databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        reference: '[Azure Defender for open-source relational databases should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        description: 'Azure Defender for open-source relational databases detects
          anomalous activities indicating unusual and potentially harmful attempts
          to access or exploit databases. Learn more about the capabilities of Azure
          Defender for open-source relational databases at [https://aka.ms/AzDforOpenSourceDBsDocu](https://aka.ms/AzDforOpenSourceDBsDocu).
          Important: Enabling this plan will result in charges for protecting your
          open-source relational databases. Learn about the pricing on Security Center''s
          pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnOpenSourceRelationalDatabases_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        reference: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        description: 'Azure Defender for Resource Manager automatically monitors the
          resource management operations in your organization. Azure Defender detects
          threats and alerts you about suspicious activity. Learn more about the capabilities
          of Azure Defender for Resource Manager at [https://aka.ms/defender-for-resource-manager](https://aka.ms/defender-for-resource-manager)
          . Enabling this Azure Defender plan results in charges. Learn about the
          pricing details per region on Security Center''s pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)
          .'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnResourceManager_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        reference: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        description: Azure Defender for servers provides real-time threat protection
          for server workloads and generates hardening recommendations as well as
          alerts about suspicious activities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnVM_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        reference: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServerVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected Azure SQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected Azure
          SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        description: Audit SQL servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected MySQL flexible
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        reference: '[Azure Defender for SQL should be enabled for unprotected MySQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        description: Audit MySQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MySQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        reference: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        description: Audit PostgreSQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/PostgreSQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected SQL Managed
          Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected SQL
          Managed Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        description: Audit each SQL Managed Instance without advanced data security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Kubernetes Service clusters should have Defender profile enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa1840de2-8088-4ea8-b153-b4c723e9cb01)'
        reference: '[Azure Kubernetes Service clusters should have Defender profile
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa1840de2-8088-4ea8-b153-b4c723e9cb01)'
        description: Microsoft Defender for Containers provides cloud-native Kubernetes
          security capabilities including environment hardening, workload protection,
          and run-time protection. When you enable the SecurityProfile.AzureDefender
          on your Azure Kubernetes Service cluster, an agent is deployed to your cluster
          to collect security event data. Learn more about Microsoft Defender for
          Containers in [https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks](/azure/defender-for-cloud/defender-for-containers-introduction)
        effects:
        - Audit
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ASC_Azure_Defender_AKS_SecurityProfile_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        reference: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        description: Defender Cloud Security Posture Management (CSPM) provides enhanced
          posture capabilities and a new intelligent cloud security graph to help
          identify, prioritize, and reduce risk. Defender CSPM is available in addition
          to the free foundational security posture capabilities turned on by default
          in Defender for Cloud.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Azure_Defender_CSPM_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        reference: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        description: Microsoft Defender for Containers provides hardening, vulnerability
          assessment and run-time protections for your Azure, hybrid, and multi-cloud
          Kubernetes environments.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnContainers_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL should be enabled for unprotected Synapse
          workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        reference: '[Microsoft Defender for SQL should be enabled for unprotected
          Synapse workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        description: Enable Defender for SQL to protect your Synapse workspaces. Defender
          for SQL monitors your Synapse SQL to detect anomalous activities indicating
          unusual and potentially harmful attempts to access or exploit databases.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/TdOnSynapseWorkspaces_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        reference: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        description: Microsoft Defender for SQL provides functionality for surfacing
          and mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, discovering and classifying
          sensitive data. Once enabled, the protection status indicates that the resource
          is actively monitored. Even when Defender is enabled, multiple configuration
          settings should be validated on the agent, machine, workspace and SQL server
          to ensure active protection.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ProtectDefenderForSQLOnArc_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        reference: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        description: 'Microsoft Defender for Storage detects potential threats to
          your storage accounts. It helps prevent the three major impacts on your
          data and workload: malicious file uploads, sensitive data exfiltration,
          and data corruption. The new Defender for Storage plan includes Malware
          Scanning and Sensitive Data Threat Detection. This plan also provides a
          predictable pricing structure (per storage account) for control over coverage
          and costs.'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_Microsoft_Defender_For_Storage_Full_Audit.json)'
        severity: Medium
      - name: '[SQL server-targeted autoprovisioning should be enabled for SQL servers
          on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        reference: '[SQL server-targeted autoprovisioning should be enabled for SQL
          servers on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        description: 'To ensure your SQL VMs and Arc-enabled SQL Servers are protected,
          ensure the SQL-targeted Azure Monitoring Agent is configured to automatically
          deploy. This is also necessary if you''ve previously configured autoprovisioning
          of the Microsoft Monitoring Agent, as that component is being deprecated.
          Learn more: [https://aka.ms/SQLAMAMigration](https://aka.ms/SQLAMAMigration)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_DFSQL_AMA_Migration_Audit.json)'
        severity: Medium
      - name: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        reference: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        description: Windows Defender Exploit Guard uses the Azure Policy Guest Configuration
          agent. Exploit Guard has four components that are designed to lock down
          devices against a wide variety of attack vectors and block behaviors commonly
          used in malware attacks while enabling enterprises to balance their security
          risk and productivity requirements (Windows only).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/WindowsDefenderExploitGuard_AINE.json)'
        severity: Medium
    - name: Enable logging for security investigation
      id: Microsoft cloud security benchmark LT-3
      ownership: Shared
      policies:
      - name: '[App Service apps should have resource logs enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F91a78b24-f231-4a8a-8da9-02c35b2b6510)'
        reference: '[App Service apps should have resource logs enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F91a78b24-f231-4a8a-8da9-02c35b2b6510)'
        description: Audit enabling of resource logs on the app. This enables you
          to recreate activity trails for investigation purposes if a security incident
          occurs or your network is compromised.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/ResourceLoggingMonitoring_Audit.json)'
        severity: Medium
      - name: '[Auditing on SQL server should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9)'
        reference: '[Auditing on SQL server should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9)'
        description: Auditing on your SQL Server should be enabled to track database
          activities across all databases on the server and save them in an audit
          log.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServerAuditing_Audit.json)'
        severity: Medium
      - name: '[Diagnostic logs in Azure AI services resources should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b4d1c4e-934c-4703-944c-27c82c06bebb)'
        reference: '[Diagnostic logs in Azure AI services resources should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b4d1c4e-934c-4703-944c-27c82c06bebb)'
        description: Enable logs for Azure AI services resources. This enables you
          to recreate activity trails for investigation purposes, when a security
          incident occurs or your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Ai%20Services/DiagnosticLogs_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Azure Data Lake Store should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F057ef27e-665e-4328-8ea3-04b3122bd9fb)'
        reference: '[Resource logs in Azure Data Lake Store should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F057ef27e-665e-4328-8ea3-04b3122bd9fb)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Data%20Lake/Store_AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Azure Databricks Workspaces should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F138ff14d-b687-4faa-a81c-898c91a87fa2)'
        reference: '[Resource logs in Azure Databricks Workspaces should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F138ff14d-b687-4faa-a81c-898c91a87fa2)'
        description: Resource logs enable recreating activity trails to use for investigation
          purposes when a security incident occurs or when your network is compromised.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Databricks/Databricks_AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Azure Kubernetes Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F245fc9df-fa96-4414-9a0b-3738c2f7341c)'
        reference: '[Resource logs in Azure Kubernetes Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F245fc9df-fa96-4414-9a0b-3738c2f7341c)'
        description: Azure Kubernetes Service's resource logs can help recreate activity
          trails when investigating security incidents. Enable it to make sure the
          logs will exist when needed
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Azure Machine Learning Workspaces should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fafe0c3be-ba3b-4544-ba52-0c99672a8ad6)'
        reference: '[Resource logs in Azure Machine Learning Workspaces should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fafe0c3be-ba3b-4544-ba52-0c99672a8ad6)'
        description: Resource logs enable recreating activity trails to use for investigation
          purposes when a security incident occurs or when your network is compromised.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Azure Stream Analytics should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9be5368-9bf5-4b84-9e0a-7850da98bb46)'
        reference: '[Resource logs in Azure Stream Analytics should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff9be5368-9bf5-4b84-9e0a-7850da98bb46)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Stream%20Analytics/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Batch accounts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F428256e6-1fac-4f48-a757-df34c2b3336d)'
        reference: '[Resource logs in Batch accounts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F428256e6-1fac-4f48-a757-df34c2b3336d)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Batch/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Data Lake Analytics should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc95c74d9-38fe-4f0d-af86-0c7d626a315c)'
        reference: '[Resource logs in Data Lake Analytics should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc95c74d9-38fe-4f0d-af86-0c7d626a315c)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Data%20Lake/Analytics_AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Event Hub should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F83a214f7-d01a-484b-91a9-ed54470c9a6a)'
        reference: '[Resource logs in Event Hub should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F83a214f7-d01a-484b-91a9-ed54470c9a6a)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Event%20Hub/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in IoT Hub should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F383856f8-de7f-44a2-81fc-e5135b5c2aa4)'
        reference: '[Resource logs in IoT Hub should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F383856f8-de7f-44a2-81fc-e5135b5c2aa4)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Internet%20of%20Things/IoTHub_AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcf820ca0-f99e-4f3e-84fb-66e913812d21)'
        reference: '[Resource logs in Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcf820ca0-f99e-4f3e-84fb-66e913812d21)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Key%20Vault/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Logic Apps should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F34f95f76-5386-4de7-b824-0d8478470c9d)'
        reference: '[Resource logs in Logic Apps should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F34f95f76-5386-4de7-b824-0d8478470c9d)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Logic%20Apps/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Search services should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb4330a05-a843-4bc8-bf9a-cacce50c67f4)'
        reference: '[Resource logs in Search services should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb4330a05-a843-4bc8-bf9a-cacce50c67f4)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Search/AuditDiagnosticLog_Audit.json)'
        severity: Medium
      - name: '[Resource logs in Service Bus should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff8d36e2f-389b-4ee4-898d-21aeb69a0f45)'
        reference: '[Resource logs in Service Bus should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff8d36e2f-389b-4ee4-898d-21aeb69a0f45)'
        description: Audit enabling of resource logs. This enables you to recreate
          activity trails to use for investigation purposes; when a security incident
          occurs or when your network is compromised
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Service%20Bus/AuditDiagnosticLog_Audit.json)'
        severity: Medium
    - name: Enable network logging for security investigation
      id: Microsoft cloud security benchmark LT-4
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Network traffic data collection agent should be installed
          on Linux virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F04c4380f-3fae-46e8-96c9-30193528f602)'
        reference: '[\[Preview\]: Network traffic data collection agent should be
          installed on Linux virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F04c4380f-3fae-46e8-96c9-30193528f602)'
        description: Security Center uses the Microsoft Dependency agent to collect
          network traffic data from your Azure virtual machines to enable advanced
          network protection features such as traffic visualization on the network
          map, network hardening recommendations and specific network threats.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Monitoring/ASC_Dependency_Agent_Audit_Linux.json)'
        severity: Medium
      - name: '[\[Preview\]: Network traffic data collection agent should be installed
          on Windows virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2f2ee1de-44aa-4762-b6bd-0893fc3f306d)'
        reference: '[\[Preview\]: Network traffic data collection agent should be
          installed on Windows virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2f2ee1de-44aa-4762-b6bd-0893fc3f306d)'
        description: Security Center uses the Microsoft Dependency agent to collect
          network traffic data from your Azure virtual machines to enable advanced
          network protection features such as traffic visualization on the network
          map, network hardening recommendations and specific network threats.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Monitoring/ASC_Dependency_Agent_Audit_Windows.json)'
        severity: Medium
    - name: Centralize security log management and analysis
      id: Microsoft cloud security benchmark LT-5
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Log Analytics extension should be installed on your Linux
          Azure Arc machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F842c54e8-c2f9-4d79-ae8d-38d8b8019373)'
        reference: '[\[Preview\]: Log Analytics extension should be installed on your
          Linux Azure Arc machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F842c54e8-c2f9-4d79-ae8d-38d8b8019373)'
        description: This policy audits Linux Azure Arc machines if the Log Analytics
          extension is not installed.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Monitoring/Arc_Linux_LogAnalytics_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Log Analytics extension should be installed on your Windows
          Azure Arc machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd69b1763-b96d-40b8-a2d9-ca31e9fd0d3e)'
        reference: '[\[Preview\]: Log Analytics extension should be installed on your
          Windows Azure Arc machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd69b1763-b96d-40b8-a2d9-ca31e9fd0d3e)'
        description: This policy audits Windows Azure Arc machines if the Log Analytics
          extension is not installed.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Monitoring/Arc_Windows_LogAnalytics_Audit.json)'
        severity: Medium
    - name: Configure log storage retention
      id: Microsoft cloud security benchmark LT-6
      ownership: Shared
      policies:
      - name: '[SQL servers with auditing to storage account destination should be
          configured with 90 days retention or higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F89099bee-89e0-4b26-a5f4-165451757743)'
        reference: '[SQL servers with auditing to storage account destination should
          be configured with 90 days retention or higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F89099bee-89e0-4b26-a5f4-165451757743)'
        description: For incident investigation purposes, we recommend setting the
          data retention for your SQL Server' auditing to storage account destination
          to at least 90 days. Confirm that you are meeting the necessary retention
          rules for the regions in which you are operating. This is sometimes required
          for compliance with regulatory standards.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServerAuditingRetentionDays_Audit.json)'
        severity: Medium
  - name: Incident Response
    subcategories:
    - name: Preparation - setup incident notification
      id: Microsoft cloud security benchmark IR-2
      ownership: Shared
      policies:
      - name: '[Email notification for high severity alerts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6e2593d9-add6-4083-9c9b-4b7d2188c899)'
        reference: '[Email notification for high severity alerts should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6e2593d9-add6-4083-9c9b-4b7d2188c899)'
        description: To ensure the relevant people in your organization are notified
          when there is a potential security breach in one of your subscriptions,
          enable email notifications for high severity alerts in Security Center.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Email_notification.json)'
        severity: Medium
      - name: '[Email notification to subscription owner for high severity alerts
          should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0b15565f-aa9e-48ba-8619-45960f2c314d)'
        reference: '[Email notification to subscription owner for high severity alerts
          should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0b15565f-aa9e-48ba-8619-45960f2c314d)'
        description: To ensure your subscription owners are notified when there is
          a potential security breach in their subscription, set email notifications
          to subscription owners for high severity alerts in Security Center.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Email_notification_to_subscription_owner.json)'
        severity: Medium
      - name: '[Subscriptions should have a contact email address for security issues](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7)'
        reference: '[Subscriptions should have a contact email address for security
          issues](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7)'
        description: To ensure the relevant people in your organization are notified
          when there is a potential security breach in one of your subscriptions,
          set a security contact to receive email notifications from Security Center.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Security_contact_email.json)'
        severity: Medium
    - name: Detection and analysis - create incidents based on high-quality alerts
      id: Microsoft cloud security benchmark IR-3
      ownership: Shared
      policies:
      - name: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        reference: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        description: Azure Defender for App Service leverages the scale of the cloud,
          and the visibility that Azure has as a cloud provider, to monitor for common
          web app attacks.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnAppServices_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        reference: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServers_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        reference: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        description: Azure Defender for Key Vault provides an additional layer of
          protection and security intelligence by detecting unusual and potentially
          harmful attempts to access or exploit key vault accounts.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnKeyVaults_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for open-source relational databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        reference: '[Azure Defender for open-source relational databases should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        description: 'Azure Defender for open-source relational databases detects
          anomalous activities indicating unusual and potentially harmful attempts
          to access or exploit databases. Learn more about the capabilities of Azure
          Defender for open-source relational databases at [https://aka.ms/AzDforOpenSourceDBsDocu](https://aka.ms/AzDforOpenSourceDBsDocu).
          Important: Enabling this plan will result in charges for protecting your
          open-source relational databases. Learn about the pricing on Security Center''s
          pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnOpenSourceRelationalDatabases_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        reference: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        description: 'Azure Defender for Resource Manager automatically monitors the
          resource management operations in your organization. Azure Defender detects
          threats and alerts you about suspicious activity. Learn more about the capabilities
          of Azure Defender for Resource Manager at [https://aka.ms/defender-for-resource-manager](https://aka.ms/defender-for-resource-manager)
          . Enabling this Azure Defender plan results in charges. Learn about the
          pricing details per region on Security Center''s pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)
          .'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnResourceManager_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        reference: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        description: Azure Defender for servers provides real-time threat protection
          for server workloads and generates hardening recommendations as well as
          alerts about suspicious activities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnVM_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        reference: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServerVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected Azure SQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected Azure
          SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        description: Audit SQL servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected MySQL flexible
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        reference: '[Azure Defender for SQL should be enabled for unprotected MySQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        description: Audit MySQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MySQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        reference: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        description: Audit PostgreSQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/PostgreSQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected SQL Managed
          Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected SQL
          Managed Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        description: Audit each SQL Managed Instance without advanced data security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        reference: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        description: Defender Cloud Security Posture Management (CSPM) provides enhanced
          posture capabilities and a new intelligent cloud security graph to help
          identify, prioritize, and reduce risk. Defender CSPM is available in addition
          to the free foundational security posture capabilities turned on by default
          in Defender for Cloud.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Azure_Defender_CSPM_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        reference: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        description: Microsoft Defender for APIs brings new discovery, protection,
          detection, & response coverage to monitor for common API based attacks &
          security misconfigurations.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDefenderForAPIS_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        reference: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        description: Microsoft Defender for Containers provides hardening, vulnerability
          assessment and run-time protections for your Azure, hybrid, and multi-cloud
          Kubernetes environments.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnContainers_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL should be enabled for unprotected Synapse
          workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        reference: '[Microsoft Defender for SQL should be enabled for unprotected
          Synapse workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        description: Enable Defender for SQL to protect your Synapse workspaces. Defender
          for SQL monitors your Synapse SQL to detect anomalous activities indicating
          unusual and potentially harmful attempts to access or exploit databases.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/TdOnSynapseWorkspaces_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        reference: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        description: Microsoft Defender for SQL provides functionality for surfacing
          and mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, discovering and classifying
          sensitive data. Once enabled, the protection status indicates that the resource
          is actively monitored. Even when Defender is enabled, multiple configuration
          settings should be validated on the agent, machine, workspace and SQL server
          to ensure active protection.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ProtectDefenderForSQLOnArc_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        reference: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        description: 'Microsoft Defender for Storage detects potential threats to
          your storage accounts. It helps prevent the three major impacts on your
          data and workload: malicious file uploads, sensitive data exfiltration,
          and data corruption. The new Defender for Storage plan includes Malware
          Scanning and Sensitive Data Threat Detection. This plan also provides a
          predictable pricing structure (per storage account) for control over coverage
          and costs.'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_Microsoft_Defender_For_Storage_Full_Audit.json)'
        severity: Medium
      - name: '[SQL server-targeted autoprovisioning should be enabled for SQL servers
          on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        reference: '[SQL server-targeted autoprovisioning should be enabled for SQL
          servers on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        description: 'To ensure your SQL VMs and Arc-enabled SQL Servers are protected,
          ensure the SQL-targeted Azure Monitoring Agent is configured to automatically
          deploy. This is also necessary if you''ve previously configured autoprovisioning
          of the Microsoft Monitoring Agent, as that component is being deprecated.
          Learn more: [https://aka.ms/SQLAMAMigration](https://aka.ms/SQLAMAMigration)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_DFSQL_AMA_Migration_Audit.json)'
        severity: Medium
    - name: Detection and analysis - investigate an incident
      id: Microsoft cloud security benchmark IR-4
      ownership: Shared
      policies:
      - name: '[Network Watcher should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb6e2945c-0b7b-40f5-9233-7a5323b5cdc6)'
        reference: '[Network Watcher should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb6e2945c-0b7b-40f5-9233-7a5323b5cdc6)'
        description: Network Watcher is a regional service that enables you to monitor
          and diagnose conditions at a network scenario level in, to, and from Azure.
          Scenario level monitoring enables you to diagnose problems at an end to
          end network level view. It is required to have a network watcher resource
          group to be created in every region where a virtual network is present.
          An alert is enabled if a network watcher resource group is not available
          in a particular region.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Network/NetworkWatcher_Enabled_Audit.json)'
        severity: Medium
    - name: Detection and analysis - prioritize incidents
      id: AMicrosoft cloud security benchmark IR-5
      ownership: Shared
      policies:
      - name: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        reference: '[Azure Defender for App Service should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F2913021d-f2fd-4f3d-b958-22354e2bdbcb)'
        description: Azure Defender for App Service leverages the scale of the cloud,
          and the visibility that Azure has as a cloud provider, to monitor for common
          web app attacks.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnAppServices_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        reference: '[Azure Defender for Azure SQL Database servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7fe3b40f-802b-4cdd-8bd4-fd799c948cc2)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServers_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        reference: '[Azure Defender for Key Vault should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e6763cc-5078-4e64-889d-ff4d9a839047)'
        description: Azure Defender for Key Vault provides an additional layer of
          protection and security intelligence by detecting unusual and potentially
          harmful attempts to access or exploit key vault accounts.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnKeyVaults_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for open-source relational databases should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        reference: '[Azure Defender for open-source relational databases should be
          enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a9fbe0d-c5c4-4da8-87d8-f4fd77338835)'
        description: 'Azure Defender for open-source relational databases detects
          anomalous activities indicating unusual and potentially harmful attempts
          to access or exploit databases. Learn more about the capabilities of Azure
          Defender for open-source relational databases at [https://aka.ms/AzDforOpenSourceDBsDocu](https://aka.ms/AzDforOpenSourceDBsDocu).
          Important: Enabling this plan will result in charges for protecting your
          open-source relational databases. Learn about the pricing on Security Center''s
          pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnOpenSourceRelationalDatabases_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        reference: '[Azure Defender for Resource Manager should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc3d20c29-b36d-48fe-808b-99a87530ad99)'
        description: 'Azure Defender for Resource Manager automatically monitors the
          resource management operations in your organization. Azure Defender detects
          threats and alerts you about suspicious activity. Learn more about the capabilities
          of Azure Defender for Resource Manager at [https://aka.ms/defender-for-resource-manager](https://aka.ms/defender-for-resource-manager)
          . Enabling this Azure Defender plan results in charges. Learn about the
          pricing details per region on Security Center''s pricing page: [https://aka.ms/pricing-security-center](https://aka.ms/pricing-security-center)
          .'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAzureDefenderOnResourceManager_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        reference: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        description: Azure Defender for servers provides real-time threat protection
          for server workloads and generates hardening recommendations as well as
          alerts about suspicious activities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnVM_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        reference: '[Azure Defender for SQL servers on machines should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6581d072-105e-4418-827f-bd446d56421b)'
        description: Azure Defender for SQL provides functionality for surfacing and
          mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, and discovering and classifying
          sensitive data.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedDataSecurityOnSqlServerVirtualMachines_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected Azure SQL
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected Azure
          SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb4388-5bf4-4ad7-ba82-2cd2f41ceae9)'
        description: Audit SQL servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlServer_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected MySQL flexible
          servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        reference: '[Azure Defender for SQL should be enabled for unprotected MySQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3bc8a0d5-38e0-4a3d-a657-2cb64468fc34)'
        description: Audit MySQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MySQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        reference: '[Azure Defender for SQL should be enabled for unprotected PostgreSQL
          flexible servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd38668f5-d155-42c7-ab3d-9b57b50f8fbf)'
        description: Audit PostgreSQL flexible servers without Advanced Data Security
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/PostgreSQL_FlexibleServers_DefenderForSQL_Audit.json)'
        severity: Medium
      - name: '[Azure Defender for SQL should be enabled for unprotected SQL Managed
          Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        reference: '[Azure Defender for SQL should be enabled for unprotected SQL
          Managed Instances](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fabfb7388-5bf4-4ad7-ba99-2cd2f41cebb9)'
        description: Audit each SQL Managed Instance without advanced data security.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/SqlManagedInstance_AdvancedDataSecurity_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        reference: '[Microsoft Defender CSPM should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1f90fc71-a595-4066-8974-d4d0802e8ef0)'
        description: Defender Cloud Security Posture Management (CSPM) provides enhanced
          posture capabilities and a new intelligent cloud security graph to help
          identify, prioritize, and reduce risk. Defender CSPM is available in addition
          to the free foundational security posture capabilities turned on by default
          in Defender for Cloud.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_Azure_Defender_CSPM_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        reference: '[Microsoft Defender for APIs should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F7926a6d1-b268-4586-8197-e8ae90c877d7)'
        description: Microsoft Defender for APIs brings new discovery, protection,
          detection, & response coverage to monitor for common API based attacks &
          security misconfigurations.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableDefenderForAPIS_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        reference: '[Microsoft Defender for Containers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c988dd6-ade4-430f-a608-2a3e5b0a6d38)'
        description: Microsoft Defender for Containers provides hardening, vulnerability
          assessment and run-time protections for your Azure, hybrid, and multi-cloud
          Kubernetes environments.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnContainers_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL should be enabled for unprotected Synapse
          workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        reference: '[Microsoft Defender for SQL should be enabled for unprotected
          Synapse workspaces](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd31e5c31-63b2-4f12-887b-e49456834fa1)'
        description: Enable Defender for SQL to protect your Synapse workspaces. Defender
          for SQL monitors your Synapse SQL to detect anomalous activities indicating
          unusual and potentially harmful attempts to access or exploit databases.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/TdOnSynapseWorkspaces_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        reference: '[Microsoft Defender for SQL status should be protected for Arc-enabled
          SQL Servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F938c4981-c2c9-4168-9cd6-972b8675f906)'
        description: Microsoft Defender for SQL provides functionality for surfacing
          and mitigating potential database vulnerabilities, detecting anomalous activities
          that could indicate threats to SQL databases, discovering and classifying
          sensitive data. Once enabled, the protection status indicates that the resource
          is actively monitored. Even when Defender is enabled, multiple configuration
          settings should be validated on the agent, machine, workspace and SQL server
          to ensure active protection.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ProtectDefenderForSQLOnArc_Audit.json)'
        severity: Medium
      - name: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        reference: '[Microsoft Defender for Storage should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F640d2586-54d2-465f-877f-9ffc1d2109f4)'
        description: 'Microsoft Defender for Storage detects potential threats to
          your storage accounts. It helps prevent the three major impacts on your
          data and workload: malicious file uploads, sensitive data exfiltration,
          and data corruption. The new Defender for Storage plan includes Malware
          Scanning and Sensitive Data Threat Detection. This plan also provides a
          predictable pricing structure (per storage account) for control over coverage
          and costs.'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_Microsoft_Defender_For_Storage_Full_Audit.json)'
        severity: Medium
      - name: '[SQL server-targeted autoprovisioning should be enabled for SQL servers
          on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        reference: '[SQL server-targeted autoprovisioning should be enabled for SQL
          servers on machines plan](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc6283572-73bb-4deb-bf2c-7a2b8f7462cb)'
        description: 'To ensure your SQL VMs and Arc-enabled SQL Servers are protected,
          ensure the SQL-targeted Azure Monitoring Agent is configured to automatically
          deploy. This is also necessary if you''ve previously configured autoprovisioning
          of the Microsoft Monitoring Agent, as that component is being deprecated.
          Learn more: [https://aka.ms/SQLAMAMigration](https://aka.ms/SQLAMAMigration)'
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_DFSQL_AMA_Migration_Audit.json)'
        severity: Medium
  - name: Posture and Vulnerability Management
    subcategories:
    - name: Audit and enforce secure configurations
      id: Microsoft cloud security benchmark PV-2
      ownership: Shared
      policies:
      - name: '[\[Deprecated\]: Function apps should have ''Client Certificates (Incoming
          client certificates)'' enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Feaebaea7-8013-4ceb-9d14-7eb32271373c)'
        reference: '[\[Deprecated\]: Function apps should have ''Client Certificates
          (Incoming client certificates)'' enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Feaebaea7-8013-4ceb-9d14-7eb32271373c)'
        description: Client certificates allow for the app to request a certificate
          for incoming requests. Only clients with valid certificates will be able
          to reach the app. This policy has been replaced by a new policy with the
          same name because Http 2.0 doesn't support client certificates.
        effects:
        - Audit
        - Disabled
        version: '[3.1.0-deprecated](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/FunctionApp_Audit_ClientCert.json)'
        severity: Medium
      - name: '[API Management direct management endpoint should not be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb741306c-968e-4b67-b916-5675e5c709f4)'
        reference: '[API Management direct management endpoint should not be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fb741306c-968e-4b67-b916-5675e5c709f4)'
        description: The direct management REST API in Azure API Management bypasses
          Azure Resource Manager role-based access control, authorization, and throttling
          mechanisms, thus increasing the vulnerability of your service.
        effects:
        - Audit
        - Disabled
        - Deny
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/DirectManagementAPIEnabled_AuditDeny.json)'
        severity: High
      - name: '[API Management minimum API version should be set to 2019-12-01 or
          higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F549814b6-3212-4203-bdc8-1548d342fb67)'
        reference: '[API Management minimum API version should be set to 2019-12-01
          or higher](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F549814b6-3212-4203-bdc8-1548d342fb67)'
        description: To prevent service secrets from being shared with read-only users,
          the minimum API version should be set to 2019-12-01 or higher.
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/MinimumApiVersion_AuditDeny.json)'
        severity: High
      - name: '[App Service apps should have Client Certificates (Incoming client
          certificates) enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F19dd1db6-f442-49cf-a838-b0786b4401ef)'
        reference: '[App Service apps should have Client Certificates (Incoming client
          certificates) enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F19dd1db6-f442-49cf-a838-b0786b4401ef)'
        description: Client certificates allow for the app to request a certificate
          for incoming requests. Only clients that have a valid certificate will be
          able to reach the app. This policy applies to apps with Http version set
          to 1.1.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/ClientCert_Webapp_Audit.json)'
        severity: Medium
      - name: '[App Service apps should have remote debugging turned off](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcb510bfd-1cba-4d9f-a230-cb0976f4bb71)'
        reference: '[App Service apps should have remote debugging turned off](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fcb510bfd-1cba-4d9f-a230-cb0976f4bb71)'
        description: Remote debugging requires inbound ports to be opened on an App
          Service app. Remote debugging should be turned off.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/DisableRemoteDebugging_WebApp_Audit.json)'
        severity: Medium
      - name: '[App Service apps should not have CORS configured to allow every resource
          to access your apps](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5744710e-cc2f-4ee8-8809-3b11e89f4bc9)'
        reference: '[App Service apps should not have CORS configured to allow every
          resource to access your apps](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5744710e-cc2f-4ee8-8809-3b11e89f4bc9)'
        description: Cross-Origin Resource Sharing (CORS) should not allow all domains
          to access your app. Allow only required domains to interact with your app.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RestrictCORSAccess_WebApp_Audit.json)'
        severity: Medium
      - name: '[Azure API Management platform version should be stv2](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1dc2fc00-2245-4143-99f4-874c937f13ef)'
        reference: '[Azure API Management platform version should be stv2](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1dc2fc00-2245-4143-99f4-874c937f13ef)'
        description: Azure API Management stv1 compute platform version will be retired
          effective 31 August 2024, and these instances should be migrated to stv2
          compute platform for continued support. Learn more at [https://learn.microsoft.com/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024](/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024)
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/API%20Management/PlatformVersion_AuditDeny.json)'
        severity: High
      - name: '[Azure Arc enabled Kubernetes clusters should have the Azure Policy
          extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6b2122c1-8120-4ff5-801b-17625a355590)'
        reference: '[Azure Arc enabled Kubernetes clusters should have the Azure Policy
          extension installed](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6b2122c1-8120-4ff5-801b-17625a355590)'
        description: The Azure Policy extension for Azure Arc provides at-scale enforcements
          and safeguards on your Arc enabled Kubernetes clusters in a centralized,
          consistent manner. Learn more at [https://aka.ms/akspolicydoc](https://aka.ms/akspolicydoc).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ArcPolicyExtension_Audit.json)'
        severity: Medium
      - name: '[Azure Machine Learning compute instances should be recreated to get
          the latest software updates](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff110a506-2dcb-422e-bcea-d533fc8c35e2)'
        reference: '[Azure Machine Learning compute instances should be recreated
          to get the latest software updates](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff110a506-2dcb-422e-bcea-d533fc8c35e2)'
        description: Ensure Azure Machine Learning compute instances run on the latest
          available operating system. Security is improved and vulnerabilities reduced
          by running with the latest security patches. For more information, visit
          [https://aka.ms/azureml-ci-updates/](https://aka.ms/azureml-ci-updates/).
        effects:
        - '[parameters(''effects'')]'
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Machine%20Learning/ComputeInstanceUpdates_Audit.json)'
        severity: Low
      - name: '[Azure Policy Add-on for Kubernetes service (AKS) should be installed
          and enabled on your clusters](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a15ec92-a229-4763-bb14-0ea34a568f8d)'
        reference: '[Azure Policy Add-on for Kubernetes service (AKS) should be installed
          and enabled on your clusters](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0a15ec92-a229-4763-bb14-0ea34a568f8d)'
        description: Azure Policy Add-on for Kubernetes service (AKS) extends Gatekeeper
          v3, an admission controller webhook for Open Policy Agent (OPA), to apply
          at-scale enforcements and safeguards on your clusters in a centralized,
          consistent manner.
        effects:
        - Audit
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/AKS_AzurePolicyAddOn_Audit.json)'
        severity: Medium
      - name: '[Function apps should have remote debugging turned off](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e60b895-3786-45da-8377-9c6b4b6ac5f9)'
        reference: '[Function apps should have remote debugging turned off](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0e60b895-3786-45da-8377-9c6b4b6ac5f9)'
        description: Remote debugging requires inbound ports to be opened on Function
          apps. Remote debugging should be turned off.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/DisableRemoteDebugging_FunctionApp_Audit.json)'
        severity: Medium
      - name: '[Function apps should not have CORS configured to allow every resource
          to access your apps](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0820b7b9-23aa-4725-a1ce-ae4558f718e5)'
        reference: '[Function apps should not have CORS configured to allow every
          resource to access your apps](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0820b7b9-23aa-4725-a1ce-ae4558f718e5)'
        description: Cross-Origin Resource Sharing (CORS) should not allow all domains
          to access your Function app. Allow only required domains to interact with
          your Function app.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/App%20Service/RestrictCORSAccess_FuntionApp_Audit.json)'
        severity: Medium
      - name: '[Kubernetes cluster containers CPU and memory resource limits should
          not exceed the specified limits](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe345eecc-fa47-480f-9e88-67dcc122b164)'
        reference: '[Kubernetes cluster containers CPU and memory resource limits
          should not exceed the specified limits](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe345eecc-fa47-480f-9e88-67dcc122b164)'
        description: Enforce container CPU and memory resource limits to prevent resource
          exhaustion attacks in a Kubernetes cluster. This policy is generally available
          for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes.
          For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[9.3.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerResourceLimits.json)'
        severity: High
      - name: '[Kubernetes cluster containers should not share host process ID or
          host IPC namespace](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8)'
        reference: '[Kubernetes cluster containers should not share host process ID
          or host IPC namespace](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8)'
        description: Block pod containers from sharing the host process ID namespace
          and host IPC namespace in a Kubernetes cluster. This recommendation is part
          of CIS 5.2.2 and CIS 5.2.3 which are intended to improve the security of
          your Kubernetes environments. This policy is generally available for Kubernetes
          Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information,
          see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[5.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/BlockHostNamespace.json)'
        severity: High
      - name: '[Kubernetes cluster containers should only use allowed AppArmor profiles](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F511f5417-5d12-434d-ab2e-816901e72a5e)'
        reference: '[Kubernetes cluster containers should only use allowed AppArmor
          profiles](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F511f5417-5d12-434d-ab2e-816901e72a5e)'
        description: Containers should only use allowed AppArmor profiles in a Kubernetes
          cluster. This policy is generally available for Kubernetes Service (AKS),
          and preview for Azure Arc enabled Kubernetes. For more information, see
          [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/EnforceAppArmorProfile.json)'
        severity: High
      - name: '[Kubernetes cluster containers should only use allowed capabilities](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc26596ff-4d70-4e6a-9a30-c2506bd2f80c)'
        reference: '[Kubernetes cluster containers should only use allowed capabilities](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fc26596ff-4d70-4e6a-9a30-c2506bd2f80c)'
        description: Restrict the capabilities to reduce the attack surface of containers
          in a Kubernetes cluster. This recommendation is part of CIS 5.2.8 and CIS
          5.2.9 which are intended to improve the security of your Kubernetes environments.
          This policy is generally available for Kubernetes Service (AKS), and preview
          for Azure Arc enabled Kubernetes. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerAllowedCapabilities.json)'
        severity: High
      - name: '[Kubernetes cluster containers should only use allowed images](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffebd0533-8e55-448f-b837-bd0e06f16469)'
        reference: '[Kubernetes cluster containers should only use allowed images](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffebd0533-8e55-448f-b837-bd0e06f16469)'
        description: Use images from trusted registries to reduce the Kubernetes cluster's
          exposure risk to unknown vulnerabilities, security issues and malicious
          images. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[9.3.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerAllowedImages.json)'
        severity: High
      - name: '[Kubernetes cluster containers should run with a read only root file
          system](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdf49d893-a74c-421d-bc95-c663042e5b80)'
        reference: '[Kubernetes cluster containers should run with a read only root
          file system](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdf49d893-a74c-421d-bc95-c663042e5b80)'
        description: Run containers with a read only root file system to protect from
          changes at run-time with malicious binaries being added to PATH in a Kubernetes
          cluster. This policy is generally available for Kubernetes Service (AKS),
          and preview for Azure Arc enabled Kubernetes. For more information, see
          [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.3.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ReadOnlyRootFileSystem.json)'
        severity: High
      - name: '[Kubernetes cluster pod hostPath volumes should only use allowed host
          paths](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F098fc59e-46c7-4d99-9b16-64990e543d75)'
        reference: '[Kubernetes cluster pod hostPath volumes should only use allowed
          host paths](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F098fc59e-46c7-4d99-9b16-64990e543d75)'
        description: Limit pod HostPath volume mounts to the allowed host paths in
          a Kubernetes Cluster. This policy is generally available for Kubernetes
          Service (AKS), and Azure Arc enabled Kubernetes. For more information, see
          [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/AllowedHostPaths.json)'
        severity: High
      - name: '[Kubernetes cluster pods and containers should only run with approved
          user and group IDs](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff06ddb64-5fa3-4b77-b166-acb36f7f6042)'
        reference: '[Kubernetes cluster pods and containers should only run with approved
          user and group IDs](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff06ddb64-5fa3-4b77-b166-acb36f7f6042)'
        description: Control the user, primary group, supplemental group and file
          system group IDs that pods and containers can use to run in a Kubernetes
          Cluster. This policy is generally available for Kubernetes Service (AKS),
          and preview for Azure Arc enabled Kubernetes. For more information, see
          [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/AllowedUsersGroups.json)'
        severity: High
      - name: '[Kubernetes cluster pods should only use approved host network and
          port range](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82985f06-dc18-4a48-bc1c-b9f4f0098cfe)'
        reference: '[Kubernetes cluster pods should only use approved host network
          and port range](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82985f06-dc18-4a48-bc1c-b9f4f0098cfe)'
        description: Restrict pod access to the host network and the allowable host
          port range in a Kubernetes cluster. This recommendation is part of CIS 5.2.4
          which is intended to improve the security of your Kubernetes environments.
          This policy is generally available for Kubernetes Service (AKS), and preview
          for Azure Arc enabled Kubernetes. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[6.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/HostNetworkPorts.json)'
        severity: High
      - name: '[Kubernetes cluster services should listen only on allowed ports](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F233a2a17-77ca-4fb1-9b6b-69223d272a44)'
        reference: '[Kubernetes cluster services should listen only on allowed ports](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F233a2a17-77ca-4fb1-9b6b-69223d272a44)'
        description: Restrict services to listen only on allowed ports to secure access
          to the Kubernetes cluster. This policy is generally available for Kubernetes
          Service (AKS), and preview for Azure Arc enabled Kubernetes. For more information,
          see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[8.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ServiceAllowedPorts.json)'
        severity: High
      - name: '[Kubernetes cluster should not allow privileged containers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F95edb821-ddaf-4404-9732-666045e056b4)'
        reference: '[Kubernetes cluster should not allow privileged containers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F95edb821-ddaf-4404-9732-666045e056b4)'
        description: Do not allow privileged containers creation in a Kubernetes cluster.
          This recommendation is part of CIS 5.2.1 which is intended to improve the
          security of your Kubernetes environments. This policy is generally available
          for Kubernetes Service (AKS), and preview for Azure Arc enabled Kubernetes.
          For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[9.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerNoPrivilege.json)'
        severity: High
      - name: '[Kubernetes clusters should disable automounting API credentials](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F423dd1ba-798e-40e4-9c4d-b6902674b423)'
        reference: '[Kubernetes clusters should disable automounting API credentials](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F423dd1ba-798e-40e4-9c4d-b6902674b423)'
        description: Disable automounting API credentials to prevent a potentially
          compromised Pod resource to run API commands against Kubernetes clusters.
          For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[4.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/BlockAutomountToken.json)'
        severity: High
      - name: '[Kubernetes clusters should not allow container privilege escalation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c6e92c9-99f0-4e55-9cf2-0c234dc48f99)'
        reference: '[Kubernetes clusters should not allow container privilege escalation](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c6e92c9-99f0-4e55-9cf2-0c234dc48f99)'
        description: Do not allow containers to run with privilege escalation to root
          in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which
          is intended to improve the security of your Kubernetes environments. This
          policy is generally available for Kubernetes Service (AKS), and preview
          for Azure Arc enabled Kubernetes. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[7.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerNoPrivilegeEscalation.json)'
        severity: High
      - name: '[Kubernetes clusters should not grant CAP_SYS_ADMIN security capabilities](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd2e7ea85-6b44-4317-a0be-1b951587f626)'
        reference: '[Kubernetes clusters should not grant CAP_SYS_ADMIN security capabilities](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd2e7ea85-6b44-4317-a0be-1b951587f626)'
        description: To reduce the attack surface of your containers, restrict CAP_SYS_ADMIN
          Linux capabilities. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[5.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/ContainerDisallowedSysAdminCapability.json)'
        severity: High
      - name: '[Kubernetes clusters should not use the default namespace](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9f061a12-e40d-4183-a00e-171812443373)'
        reference: '[Kubernetes clusters should not use the default namespace](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F9f061a12-e40d-4183-a00e-171812443373)'
        description: Prevent usage of the default namespace in Kubernetes clusters
          to protect against unauthorized access for ConfigMap, Pod, Secret, Service,
          and ServiceAccount resource types. For more information, see [https://aka.ms/kubepolicydoc](https://aka.ms/kubepolicydoc).
        effects:
        - audit
        - Audit
        - deny
        - Deny
        - disabled
        - Disabled
        version: '[4.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/BlockDefaultNamespace.json)'
        severity: High
    - name: Audit and enforce secure configurations for compute resources
      id: Microsoft cloud security benchmark PV-4
      ownership: Shared
      policies:
      - name: '[\[Preview\]: Azure Stack HCI servers should have consistently enforced
          application control policies](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdad3a6b9-4451-492f-a95c-69efc6f3fada)'
        reference: '[\[Preview\]: Azure Stack HCI servers should have consistently
          enforced application control policies](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fdad3a6b9-4451-492f-a95c-69efc6f3fada)'
        description: At a minimum, apply the Microsoft WDAC base policy in enforced
          mode on all Azure Stack HCI servers. Applied Windows Defender Application
          Control (WDAC) policies must be consistent across servers in the same cluster.
        effects:
        - Audit
        - Disabled
        - AuditIfNotExists
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Stack%20HCI/WdacComplianceAtCluster_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Azure Stack HCI servers should meet Secured-core requirements](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5e6bf724-0154-49bc-985f-27b2e07e636b)'
        reference: '[\[Preview\]: Azure Stack HCI servers should meet Secured-core
          requirements](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F5e6bf724-0154-49bc-985f-27b2e07e636b)'
        description: 'Ensure that all Azure Stack HCI servers meet the Secured-core
          requirements. To enable the Secured-core server requirements: 1. From the
          Azure Stack HCI clusters page, go to Windows Admin Center and select Connect.
          2. Go to the Security extension and select Secured-core. 3. Select any setting
          that is not enabled and click Enable.'
        effects:
        - Audit
        - Disabled
        - AuditIfNotExists
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Stack%20HCI/SecuredCoreComplianceAtCluster_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Guest Attestation extension should be installed on supported
          Linux virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F672fe5a1-2fcd-42d7-b85d-902b6e28c6ff)'
        reference: '[\[Preview\]: Guest Attestation extension should be installed
          on supported Linux virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F672fe5a1-2fcd-42d7-b85d-902b6e28c6ff)'
        description: Install Guest Attestation extension on supported Linux virtual
          machines to allow Azure Security Center to proactively attest and monitor
          the boot integrity. Once installed, boot integrity will be attested via
          Remote Attestation. This assessment applies to Trusted Launch and Confidential
          Linux virtual machines.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[6.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_InstallLinuxGAExtOnVm_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Guest Attestation extension should be installed on supported
          Linux virtual machines scale sets](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa21f8c92-9e22-4f09-b759-50500d1d2dda)'
        reference: '[\[Preview\]: Guest Attestation extension should be installed
          on supported Linux virtual machines scale sets](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fa21f8c92-9e22-4f09-b759-50500d1d2dda)'
        description: Install Guest Attestation extension on supported Linux virtual
          machines scale sets to allow Azure Security Center to proactively attest
          and monitor the boot integrity. Once installed, boot integrity will be attested
          via Remote Attestation.  This assessment applies to Trusted Launch and Confidential
          Linux virtual machine scale sets.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[5.1.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_InstallLinuxGAExtOnVmss_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Guest Attestation extension should be installed on supported
          Windows virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1cb4d9c2-f88f-4069-bee0-dba239a57b09)'
        reference: '[\[Preview\]: Guest Attestation extension should be installed
          on supported Windows virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1cb4d9c2-f88f-4069-bee0-dba239a57b09)'
        description: Install Guest Attestation extension on supported virtual machines
          to allow Azure Security Center to proactively attest and monitor the boot
          integrity. Once installed, boot integrity will be attested via Remote Attestation.
          This assessment applies to Trusted Launch and Confidential Windows virtual
          machines.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[4.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_InstallWindowsGAExtOnVm_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Guest Attestation extension should be installed on supported
          Windows virtual machines scale sets](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff655e522-adff-494d-95c2-52d4f6d56a42)'
        reference: '[\[Preview\]: Guest Attestation extension should be installed
          on supported Windows virtual machines scale sets](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff655e522-adff-494d-95c2-52d4f6d56a42)'
        description: Install Guest Attestation extension on supported virtual machines
          scale sets to allow Azure Security Center to proactively attest and monitor
          the boot integrity. Once installed, boot integrity will be attested via
          Remote Attestation. This assessment applies to Trusted Launch and Confidential
          Windows virtual machine scale sets.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.1.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_InstallWindowsGAExtOnVmss_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Linux virtual machines should use only signed and trusted
          boot components](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F13a6c84f-49a5-410a-b5df-5b880c3fe009)'
        reference: '[\[Preview\]: Linux virtual machines should use only signed and
          trusted boot components](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F13a6c84f-49a5-410a-b5df-5b880c3fe009)'
        description: All OS boot components (boot loader, kernel, kernel drivers)
          must be signed by trusted publishers. Defender for Cloud has identified
          untrusted OS boot components on one or more of your Linux machines. To protect
          your machines from potentially malicious components, add them to your allow
          list or remove the identified components.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_BootComponent_Signature_Linux_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: Secure Boot should be enabled on supported Windows virtual
          machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F97566dd7-78ae-4997-8b36-1c7bfe0d8121)'
        reference: '[\[Preview\]: Secure Boot should be enabled on supported Windows
          virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F97566dd7-78ae-4997-8b36-1c7bfe0d8121)'
        description: Enable Secure Boot on supported Windows virtual machines to mitigate
          against malicious and unauthorized changes to the boot chain. Once enabled,
          only trusted bootloaders, kernel and kernel drivers will be allowed to run.
          This assessment applies to Trusted Launch and Confidential Windows virtual
          machines.
        effects:
        - Audit
        - Disabled
        version: '[4.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableWindowsSB_Audit.json)'
        severity: Medium
      - name: '[\[Preview\]: vTPM should be enabled on supported virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c30f9cd-b84c-49cc-aa2c-9288447cc3b3)'
        reference: '[\[Preview\]: vTPM should be enabled on supported virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1c30f9cd-b84c-49cc-aa2c-9288447cc3b3)'
        description: Enable virtual TPM device on supported virtual machines to facilitate
          Measured Boot and other OS security features that require a TPM. Once enabled,
          vTPM can be used to attest boot integrity. This assessment only applies
          to trusted launch enabled virtual machines.
        effects:
        - Audit
        - Disabled
        version: '[2.0.0-preview](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableVTPM_Audit.json)'
        severity: Medium
      - name: '[Guest Configuration extension should be installed on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fae89ebca-1c92-4898-ac2c-9f63decb045c)'
        reference: '[Guest Configuration extension should be installed on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fae89ebca-1c92-4898-ac2c-9f63decb045c)'
        description: To ensure secure configurations of in-guest settings of your
          machine, install the Guest Configuration extension. In-guest settings that
          the extension monitors include the configuration of the operating system,
          application configuration or presence, and environment settings. Once installed,
          in-guest policies will be available such as 'Windows Exploit guard should
          be enabled'. Learn more at [https://aka.ms/gcpol](https://aka.ms/gcpol).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_GCExtOnVm.json)'
        severity: Medium
      - name: '[Linux machines should meet requirements for the Azure compute security
          baseline](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc9b3da7-8347-4380-8e70-0a0361d8dedd)'
        reference: '[Linux machines should meet requirements for the Azure compute
          security baseline](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffc9b3da7-8347-4380-8e70-0a0361d8dedd)'
        description: Requires that prerequisites are deployed to the policy assignment
          scope. For details, visit [https://aka.ms/gcpol](https://aka.ms/gcpol).
          Machines are non-compliant if the machine is not configured correctly for
          one of the recommendations in the Azure compute security baseline.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.2.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/AzureLinuxBaseline_AINE.json)'
        severity: Medium
      - name: '[Virtual machines'' Guest Configuration extension should be deployed
          with system-assigned managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd26f7642-7545-4e18-9b75-8c9bbdee3a9a)'
        reference: '[Virtual machines'' Guest Configuration extension should be deployed
          with system-assigned managed identity](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fd26f7642-7545-4e18-9b75-8c9bbdee3a9a)'
        description: The Guest Configuration extension requires a system assigned
          managed identity. Azure virtual machines in the scope of this policy will
          be non-compliant when they have the Guest Configuration extension installed
          but do not have a system assigned managed identity. Learn more at [https://aka.ms/gcpol](https://aka.ms/gcpol)
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_GCExtOnVmWithNoSAMI.json)'
        severity: Medium
      - name: '[Windows machines should meet requirements of the Azure compute security
          baseline](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F72650e9f-97bc-4b2a-ab5f-9781a9fcecbc)'
        reference: '[Windows machines should meet requirements of the Azure compute
          security baseline](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F72650e9f-97bc-4b2a-ab5f-9781a9fcecbc)'
        description: Requires that prerequisites are deployed to the policy assignment
          scope. For details, visit [https://aka.ms/gcpol](https://aka.ms/gcpol).
          Machines are non-compliant if the machine is not configured correctly for
          one of the recommendations in the Azure compute security baseline.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/AzureWindowsBaseline_AINE.json)'
        severity: Medium
    - name: Perform vulnerability assessments
      id: Microsoft cloud security benchmark PV-5
      ownership: Shared
      policies:
      - name: '[A vulnerability assessment solution should be enabled on your virtual
          machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F501541f7-f7e7-4cd6-868c-4190fdad3ac9)'
        reference: '[A vulnerability assessment solution should be enabled on your
          virtual machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F501541f7-f7e7-4cd6-868c-4190fdad3ac9)'
        description: Audits virtual machines to detect whether they are running a
          supported vulnerability assessment solution. A core component of every cyber
          risk and security program is the identification and analysis of vulnerabilities.
          Azure Security Center's standard pricing tier includes vulnerability scanning
          for your virtual machines at no extra cost. Additionally, Security Center
          can automatically deploy this tool for you.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ServerVulnerabilityAssessment_Audit.json)'
        severity: Medium
      - name: '[Machines should have secret findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3ac7c827-eea2-4bde-acc7-9568cd320efa)'
        reference: '[Machines should have secret findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F3ac7c827-eea2-4bde-acc7-9568cd320efa)'
        description: Audits virtual machines to detect whether they contain secret
          findings from the secret scanning solutions on your virtual machines.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.2](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ServerSecretAssessment_Audit.json)'
        severity: Medium
      - name: '[Vulnerability assessment should be enabled on SQL Managed Instance](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b7aa243-30e4-4c9e-bca8-d0d3022b634a)'
        reference: '[Vulnerability assessment should be enabled on SQL Managed Instance](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F1b7aa243-30e4-4c9e-bca8-d0d3022b634a)'
        description: Audit each SQL Managed Instance which doesn't have recurring
          vulnerability assessment scans enabled. Vulnerability assessment can discover,
          track, and help you remediate potential database vulnerabilities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/VulnerabilityAssessmentOnManagedInstance_Audit.json)'
        severity: Medium
      - name: '[Vulnerability assessment should be enabled on your SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9)'
        reference: '[Vulnerability assessment should be enabled on your SQL servers](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9)'
        description: Audit Azure SQL servers which do not have vulnerability assessment
          properly configured. Vulnerability assessment can discover, track, and help
          you remediate potential database vulnerabilities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/VulnerabilityAssessmentOnServer_Audit.json)'
        severity: Medium
    - name: Rapidly and automatically remediate vulnerabilities
      id: Microsoft cloud security benchmark PV-6
      ownership: Shared
      policies:
      - name: '[Azure registry container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F090c7b07-b4ed-4561-ad20-e9075f3ccaff)'
        reference: '[Azure registry container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F090c7b07-b4ed-4561-ad20-e9075f3ccaff)'
        description: Container image vulnerability assessment scans your registry
          for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability
          report for each image. Resolving vulnerabilities can greatly improve your
          security posture, ensuring images are safe to use prior to deployment.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_AzureContainerRegistryVulnerabilityAssessment_Audit.json)'
        severity: Medium
      - name: '[Azure running container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17f4b1cc-c55c-4d94-b1f9-2978f6ac2957)'
        reference: '[Azure running container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17f4b1cc-c55c-4d94-b1f9-2978f6ac2957)'
        description: Container image vulnerability assessment scans your registry
          for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability
          report for each image. This recommendation provides visibility to vulnerable
          images currently running in your Kubernetes clusters. Remediating vulnerabilities
          in container images that are currently running is key to improving your
          security posture, significantly reducing the attack surface for your containerized
          workloads.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_K8sRuningImagesVulnerabilityAssessmentBasedOnMDVM_Audit.json)'
        severity: Medium
      - name: '[Machines should be configured to periodically check for missing system
          updates](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbd876905-5b84-4f73-ab2d-2e7a7c4568d9)'
        reference: '[Machines should be configured to periodically check for missing
          system updates](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbd876905-5b84-4f73-ab2d-2e7a7c4568d9)'
        description: 'To ensure periodic assessments for missing system updates are
          triggered automatically every 24 hours, the AssessmentMode property should
          be set to ''AutomaticByPlatform''. Learn more about AssessmentMode property
          for Windows: [https://aka.ms/computevm-windowspatchassessmentmode,](https://aka.ms/computevm-windowspatchassessmentmode,)
          for Linux: [https://aka.ms/computevm-linuxpatchassessmentmode](https://aka.ms/computevm-linuxpatchassessmentmode).'
        effects:
        - Audit
        - Deny
        - Disabled
        version: '[3.7.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Azure%20Update%20Manager/AzUpdateMgmtCenter_AutoAssessmentMode_Audit.json)'
        severity: High
      - name: '[SQL databases should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffeedbf84-6b99-488c-acc2-71c829aa5ffc)'
        reference: '[SQL databases should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ffeedbf84-6b99-488c-acc2-71c829aa5ffc)'
        description: Monitor vulnerability assessment scan results and recommendations
          for how to remediate database vulnerabilities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[4.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_SQLDbVulnerabilities_Audit.json)'
        severity: Medium
      - name: '[SQL servers on machines should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6ba6d016-e7c3-4842-b8f2-4992ebc0d72d)'
        reference: '[SQL servers on machines should have vulnerability findings resolved](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F6ba6d016-e7c3-4842-b8f2-4992ebc0d72d)'
        description: SQL vulnerability assessment scans your database for security
          vulnerabilities, and exposes any deviations from best practices such as
          misconfigurations, excessive permissions, and unprotected sensitive data.
          Resolving the vulnerabilities found can greatly improve your database security
          posture.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_ServerSQLVulnerabilityAssessment_Audit.json)'
        severity: Medium
      - name: '[System updates should be installed on your machines (powered by Update
          Center)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff85bf3e0-d513-442e-89c3-1784ad63382b)'
        reference: '[System updates should be installed on your machines (powered
          by Update Center)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Ff85bf3e0-d513-442e-89c3-1784ad63382b)'
        description: Your machines are missing system, security, and critical updates.
          Software updates often include critical patches to security holes. Such
          holes are frequently exploited in malware attacks so it's vital to keep
          your software updated. To install all outstanding patches and secure your
          machines, follow the remediation steps.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_MissingSystemUpdatesV2_Audit.json)'
        severity: Medium
      - name: '[Vulnerabilities in security configuration on your machines should
          be remediated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15)'
        reference: '[Vulnerabilities in security configuration on your machines should
          be remediated](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fe1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15)'
        description: Servers which do not satisfy the configured baseline will be
          monitored by Azure Security Center as recommendations
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.1.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_OSVulnerabilities_Audit.json)'
        severity: Medium
  - name: Endpoint Security
    subcategories:
    - name: Use Endpoint Detection and Response (EDR)
      id: Microsoft cloud security benchmark ES-1
      ownership: Shared
      policies:
      - name: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        reference: '[Azure Defender for servers should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F4da35fc9-c9e7-4960-aec9-797fe7d9051d)'
        description: Azure Defender for servers provides real-time threat protection
          for server workloads and generates hardening recommendations as well as
          alerts about suspicious activities.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.3](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/ASC_EnableAdvancedThreatProtectionOnVM_Audit.json)'
        severity: Medium
    - name: Use modern anti-malware software
      id: Microsoft cloud security benchmark ES-2
      ownership: Shared
      policies:
      - name: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        reference: '[Windows Defender Exploit Guard should be enabled on your machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2Fbed48b13-6647-468e-aa2f-1af1d3f4dd40)'
        description: Windows Defender Exploit Guard uses the Azure Policy Guest Configuration
          agent. Exploit Guard has four components that are designed to lock down
          devices against a wide variety of attack vectors and block behaviors commonly
          used in malware attacks while enabling enterprises to balance their security
          risk and productivity requirements (Windows only).
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[2.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Guest%20Configuration/WindowsDefenderExploitGuard_AINE.json)'
        severity: Medium
  - name: Backup and Recovery
    subcategories:
    - name: Ensure regular automated backups
      id: Microsoft cloud security benchmark BR-1
      ownership: Shared
      policies:
      - name: '[Azure Backup should be enabled for Virtual Machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F013e242c-8828-4970-87b3-ab247555486d)'
        reference: '[Azure Backup should be enabled for Virtual Machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F013e242c-8828-4970-87b3-ab247555486d)'
        description: Ensure protection of your Azure Virtual Machines by enabling
          Azure Backup. Azure Backup is a secure and cost effective data protection
          solution for Azure.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Backup/VirtualMachines_EnableAzureBackup_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for MariaDB](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0ec47710-77ff-4a3d-9181-6aa50af424d0)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          MariaDB](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0ec47710-77ff-4a3d-9181-6aa50af424d0)'
        description: Azure Database for MariaDB allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForMariaDB_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for MySQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82339799-d096-41ae-8538-b108becf0970)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          MySQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82339799-d096-41ae-8538-b108becf0970)'
        description: Azure Database for MySQL allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForMySQL_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for PostgreSQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F48af4db5-9b8b-401c-8e74-076be876a430)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          PostgreSQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F48af4db5-9b8b-401c-8e74-076be876a430)'
        description: Azure Database for PostgreSQL allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForPostgreSQL_Audit.json)'
        severity: Medium
    - name: Protect backup and recovery data
      id: Microsoft cloud security benchmark BR-2
      ownership: Shared
      policies:
      - name: '[Azure Backup should be enabled for Virtual Machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F013e242c-8828-4970-87b3-ab247555486d)'
        reference: '[Azure Backup should be enabled for Virtual Machines](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F013e242c-8828-4970-87b3-ab247555486d)'
        description: Ensure protection of your Azure Virtual Machines by enabling
          Azure Backup. Azure Backup is a secure and cost effective data protection
          solution for Azure.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[3.0.0](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Backup/VirtualMachines_EnableAzureBackup_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for MariaDB](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0ec47710-77ff-4a3d-9181-6aa50af424d0)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          MariaDB](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F0ec47710-77ff-4a3d-9181-6aa50af424d0)'
        description: Azure Database for MariaDB allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForMariaDB_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for MySQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82339799-d096-41ae-8538-b108becf0970)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          MySQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F82339799-d096-41ae-8538-b108becf0970)'
        description: Azure Database for MySQL allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForMySQL_Audit.json)'
        severity: Medium
      - name: '[Geo-redundant backup should be enabled for Azure Database for PostgreSQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F48af4db5-9b8b-401c-8e74-076be876a430)'
        reference: '[Geo-redundant backup should be enabled for Azure Database for
          PostgreSQL](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F48af4db5-9b8b-401c-8e74-076be876a430)'
        description: Azure Database for PostgreSQL allows you to choose the redundancy
          option for your database server. It can be set to a geo-redundant backup
          storage in which the data is not only stored within the region in which
          your server is hosted, but is also replicated to a paired region to provide
          recovery option in case of a region failure. Configuring geo-redundant storage
          for backup is only allowed during server create.
        effects:
        - Audit
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/SQL/GeoRedundant_DBForPostgreSQL_Audit.json)'
        severity: Medium
  - name: DevOps Security
    subcategories:
    - name: Enforce security of workload throughout DevOps lifecycle
      id: Microsoft cloud security benchmark DS-6
      ownership: Shared
      policies:
      - name: '[Azure registry container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F090c7b07-b4ed-4561-ad20-e9075f3ccaff)'
        reference: '[Azure registry container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F090c7b07-b4ed-4561-ad20-e9075f3ccaff)'
        description: Container image vulnerability assessment scans your registry
          for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability
          report for each image. Resolving vulnerabilities can greatly improve your
          security posture, ensuring images are safe to use prior to deployment.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_AzureContainerRegistryVulnerabilityAssessment_Audit.json)'
        severity: Medium
      - name: '[Azure running container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17f4b1cc-c55c-4d94-b1f9-2978f6ac2957)'
        reference: '[Azure running container images should have vulnerabilities resolved
          (powered by Microsoft Defender Vulnerability Management)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2Fproviders%2FMicrosoft.Authorization%2FpolicyDefinitions%2F17f4b1cc-c55c-4d94-b1f9-2978f6ac2957)'
        description: Container image vulnerability assessment scans your registry
          for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability
          report for each image. This recommendation provides visibility to vulnerable
          images currently running in your Kubernetes clusters. Remediating vulnerabilities
          in container images that are currently running is key to improving your
          security posture, significantly reducing the attack surface for your containerized
          workloads.
        effects:
        - AuditIfNotExists
        - Disabled
        version: '[1.0.1](https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Security%20Center/MDC_K8sRuningImagesVulnerabilityAssessmentBasedOnMDVM_Audit.json)'
        severity: Medium
  - name: Next steps
    subcategories: []
